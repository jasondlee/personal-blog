<!DOCTYPE html>
<html>
<head>
    <title>Coming Up for Air : Using Server Sent Events and the GlassFish REST Interface</title>

    <script src="/assets/js/simple-jekyll-search.min.js" type="text/javascript"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3GQK1YDRQM"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-3GQK1YDRQM');
    </script>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="me" href="https://mastodon.cloud/@jasondlee"/>

    <link rel="alternate" type="application/rss+xml" title="jasondl.ee RSS feed" href="/feed.xml">

    <link rel="stylesheet" href="/assets/css/main.css" />

    <!-- Web Fonts -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Cherry+Cream+Soda">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Philosopher">
    <link rel="stylesheet" type="text/css" href="/assets/css/font-awesome.min.css"/>

    <link rel="stylesheet" href="https://unpkg.com/primeflex@3.1.2/primeflex.css"/>
    <link rel="stylesheet" href="https://unpkg.com/primeflex/themes/saga-blue.css"/>
    <link rel="author" href="/images/profile-pic.jpg"/>
</head>
<body>
<div class="grid">
    <div class="col blogname">
        <span>
            <a href="https://jasondl.ee">Coming Up for Air</a>
        </span>
    </div>
</div>
<div class="grid main">
    <div class="col-9">
        <div id="content">
            <article class="post">
    <h1 class="title" style="border-bottom: solid 1px #47586d; margin-bottom: 0.25rem;">
        Using Server Sent Events and the GlassFish REST Interface
    </h1>
    Monday, December 10, 2012 | <span class="share-page" style="">
  <a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://jasondl.ee/2012/using-server-sent-events-and-the-glassfish-rest-interface&title=Using Server Sent Events and the GlassFish REST Interface" rel="nofollow" target="_blank" title="Share on LinkedIn">
      <i class="fa fa-linkedin-square"></i>
  </a>
  <a class="share-twitter" href="https://twitter.com/intent/tweet?text=Using Server Sent Events and the GlassFish REST Interface&url=https://jasondl.ee/2012/using-server-sent-events-and-the-glassfish-rest-interface&via=jasondlee&related=jasondlee" rel="nofollow" target="_blank" title="Share on Twitter">
      <i class="fa fa-twitter-square"></i>
  </a>
  <a class="share-facebook" href="https://facebook.com/sharer.php?u=https://jasondl.ee/2012/using-server-sent-events-and-the-glassfish-rest-interface" rel="nofollow" target="_blank" title="Share on Facebook">
      <i class="fa fa-facebook-square"></i>
  </a>
  <a class="share-reddit" href="https://www.reddit.com/submit?url=https://jasondl.ee/2012/using-server-sent-events-and-the-glassfish-rest-interface" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Reddit" >
      <i class="fa fa-reddit-square"></i>
  </a>
  <a class="share-email" href="mailto:?subject=Using Server Sent Events and the GlassFish REST Interface&amp;body=Using Server Sent Events and the GlassFish REST Interface https://jasondl.ee/2012/using-server-sent-events-and-the-glassfish-rest-interface" title="Share via Email" >
      <i class="fa fa-envelope"></i>
  </a>
</span>

    <div>
        <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Wikipedia defines Server-Sent Events as "a technology for providing push notifications from a server to a browser client in the form of DOM events. The Server-Sent Events EventSource API is now being standardized as part of HTML5 by the W3C."  It&#8217;s a great alternative to polling the server for updates.  Long story short, thanks to the work of the <a href="http://jersey.java.net">Jersey</a> team, we have "easy" access to this in GlassFish, and we&#8217;ve added support for it to our RESTful administration interface.  Let&#8217;s take a look at a quick sample.</p>
</div>
<div class="paragraph">
<p>I should explain my scare quotes above, before we get too far, and I&#8217;ll start with two brutally honest admissions: 1) I didn&#8217;t write most of the SSE support we&#8217;ll see today, 2) I don&#8217;t understand yet, some of the mechanics.  Whew! I feel better. :P  One more caveat: this is not intended to be a general REST/SSE how to (though I might try my hand at one later), but, rather, a GlassFish REST admin SSE discussion.  If you&#8217;re not interested in managing GlassFish via our REST APIs, then this might not interest you much. Or it might.  Either way, you&#8217;ve been warned.</p>
</div>
<div class="paragraph">
<p>With that out of the way, I need to describe a few GlassFish architectural items. The first, and most important for our purposes here, is the primary way, fundamentally, of interacting with the various GlassFish backend subsystems is the <code>AdminCommand</code>.  Every REST resource we expose is ultimately based on this building block. (There are a number of technical and historical reasons for this that are out of scope here).</p>
</div>
<div class="paragraph">
<p>The second architectural item to note is a&#8230;&#8203; type of REST resource we&#8217;ve termed "composite resources".  These are not composites of other REST resources, but of 1 or more <code>AdminCommand</code> invocations. In GlassFish 3.x, each REST request was backed ultimately by a call to a single <code>AdminCommand</code>, which resulted in a very fine-grained API. For GlassFish 4.x, one of our goals is to provide a framework for quickly and easiliy writing management REST interfaces that expose a higher-level (more coarsely-grained) API.  That, in a nutshell, is the goal of composite resources.</p>
</div>
<div class="paragraph">
<p>I tell you all of that for two reasons. The first is that I&#8217;ve had people ask for more details on the background, and the second is that we&#8217;ll be dealing with both of those in this entry, so it will help to understand their backgrounds.  With all of that said, let&#8217;s get to the code.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="the-server-side">The Server Side</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Currently, we don&#8217;t have any REST resources in the <a href="https://svn.java.net/svn/glassfish~svn/trunk/main">GlassFish repo</a> to demonstrate this, but that&#8217;s not going to stop us: We&#8217;re going to write one right here! :P</p>
</div>
<div class="paragraph">
<p>Let&#8217;s first, then, take a look at an <code>AdminCommand</code>.  One of the main reasons to use SSE is that the REST request might take a while (take, for example, cluster creation).  What this new SSE support will allow us to do is expose the functionality in such a way that will allow the client to send the request, then be notified, asynchronously, of the progress as the request is processed.  That will allow the client to do other things, if it so chooses, while the request is being handled.  What we need, then, is a long-running <code>AdminCommand</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="code"><pre><span style="color: #8250df">@Service</span><span style="color: #0550ae">(</span><span style="color: #24292f;background-color: #f6f8fa">name</span> <span style="color: #0550ae">=</span> <span style="color: #0a3069">"slow-command"</span><span style="color: #0550ae">)</span>
<span style="color: #8250df">@PerLookup</span>
<span style="color: #8250df">@ExecuteOn</span><span style="color: #0550ae">(</span><span style="color: #953800">RuntimeType</span><span style="color: #0550ae">.</span><span style="color: #116329">DAS</span><span style="color: #0550ae">)</span>
<span style="color: #8250df">@CommandLock</span><span style="color: #0550ae">(</span><span style="color: #953800">CommandLock</span><span style="color: #0550ae">.</span><span style="color: #116329">LockType</span><span style="color: #0550ae">.</span><span style="color: #116329">NONE</span><span style="color: #0550ae">)</span>
<span style="color: #8250df">@Progress</span><span style="color: #0550ae">(</span><span style="color: #24292f;background-color: #f6f8fa">totalStepCount</span> <span style="color: #0550ae">=</span> <span style="color: #0550ae">5</span><span style="color: #0550ae">)</span>
<span style="color: #cf222e">public</span> <span style="color: #cf222e">class</span> <span style="color: #953800">SlowAdminCommand</span> <span style="color: #cf222e">implements</span> <span style="color: #953800">AdminCommand</span> <span style="color: #0550ae">{</span>
    <span style="color: #cf222e">public</span> <span style="color: #cf222e">void</span> <span style="color: #8250df">execute</span><span style="color: #0550ae">(</span><span style="color: #953800">AdminCommandContext</span> <span style="color: #24292f;background-color: #f6f8fa">context</span><span style="color: #0550ae">)</span> <span style="color: #0550ae">{</span>
        <span style="color: #953800">ProgressStatus</span> <span style="color: #24292f;background-color: #f6f8fa">progressStatus</span> <span style="color: #0550ae">=</span> <span style="color: #24292f;background-color: #f6f8fa">context</span><span style="color: #0550ae">.</span><span style="color: #116329">getProgressStatus</span><span style="color: #0550ae">();</span>
        <span style="color: #953800">ActionReport</span> <span style="color: #24292f;background-color: #f6f8fa">report</span> <span style="color: #0550ae">=</span> <span style="color: #24292f;background-color: #f6f8fa">context</span><span style="color: #0550ae">.</span><span style="color: #116329">getActionReport</span><span style="color: #0550ae">();</span>

        <span style="color: #cf222e">for</span> <span style="color: #0550ae">(</span><span style="color: #cf222e">int</span> <span style="color: #24292f;background-color: #f6f8fa">i</span> <span style="color: #0550ae">=</span> <span style="color: #0550ae">1</span><span style="color: #0550ae">;</span> <span style="color: #24292f;background-color: #f6f8fa">i</span> <span style="color: #0550ae">&lt;=</span> <span style="color: #0550ae">5</span><span style="color: #0550ae">;</span> <span style="color: #24292f;background-color: #f6f8fa">i</span><span style="color: #0550ae">++)</span> <span style="color: #0550ae">{</span>
            <span style="color: #24292f;background-color: #f6f8fa">sleep</span><span style="color: #0550ae">();</span>
            <span style="color: #24292f;background-color: #f6f8fa">progressStatus</span><span style="color: #0550ae">.</span><span style="color: #116329">progress</span><span style="color: #0550ae">(</span><span style="color: #24292f;background-color: #f6f8fa">i</span><span style="color: #0550ae">,</span> <span style="color: #0a3069">"Finished step #"</span> <span style="color: #0550ae">+</span> <span style="color: #24292f;background-color: #f6f8fa">i</span><span style="color: #0550ae">);</span>
        <span style="color: #0550ae">}</span>

        <span style="color: #24292f;background-color: #f6f8fa">report</span><span style="color: #0550ae">.</span><span style="color: #116329">appendMessage</span><span style="color: #0550ae">(</span><span style="color: #0a3069">"Slow command completed."</span><span style="color: #0550ae">);</span>
    <span style="color: #0550ae">}</span>

    <span style="color: #cf222e">protected</span> <span style="color: #cf222e">void</span> <span style="color: #8250df">sleep</span><span style="color: #0550ae">()</span> <span style="color: #0550ae">{</span>
        <span style="color: #cf222e">try</span> <span style="color: #0550ae">{</span>
            <span style="color: #953800">Thread</span><span style="color: #0550ae">.</span><span style="color: #116329">sleep</span><span style="color: #0550ae">(</span><span style="color: #0550ae">1000</span><span style="color: #0550ae">);</span>
        <span style="color: #0550ae">}</span> <span style="color: #cf222e">catch</span> <span style="color: #0550ae">(</span><span style="color: #953800">InterruptedException</span> <span style="color: #24292f;background-color: #f6f8fa">ex</span><span style="color: #0550ae">)</span> <span style="color: #0550ae">{</span>
            <span style="color: #953800">Logger</span><span style="color: #0550ae">.</span><span style="color: #116329">getLogger</span><span style="color: #0550ae">(</span><span style="color: #953800">SlowAdminCommand</span><span style="color: #0550ae">.</span><span style="color: #116329">class</span><span style="color: #0550ae">.</span><span style="color: #116329">getName</span><span style="color: #0550ae">())</span>
                <span style="color: #0550ae">.</span><span style="color: #116329">log</span><span style="color: #0550ae">(</span><span style="color: #953800">Level</span><span style="color: #0550ae">.</span><span style="color: #116329">SEVERE</span><span style="color: #0550ae">,</span> <span style="color: #0550ae">null</span><span style="color: #0550ae">,</span> <span style="color: #24292f;background-color: #f6f8fa">ex</span><span style="color: #0550ae">);</span>
        <span style="color: #0550ae">}</span>
    <span style="color: #0550ae">}</span>
<span style="color: #0550ae">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a pretty simple and boring <code>AdminCommand</code>, if you&#8217;re used to seeing them, but, in a nutshell, this command sleeps 5 times, for 1 second at a sime, updating the progress status after each sleep.  Finally, it returns a message in the <code>ActionReport</code>, another Admin infrastructure artifact.  All the bits and pieces of this are out of scope, but included here for the curious.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at how this might be exposed via REST, now.  In short, we can add new REST resources to the system by doing two things:
# Writing a JAX-RS class that extends <code>CompositeResource</code>
# Annotating that class with <code>@Service</code></p>
</div>
<div class="paragraph">
<p>Here is how this might look:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="code"><pre><span style="color: #8250df">@Service</span>
<span style="color: #8250df">@Path</span><span style="color: #0550ae">(</span><span style="color: #0a3069">"/slow"</span><span style="color: #0550ae">)</span>
<span style="color: #cf222e">public</span> <span style="color: #cf222e">class</span> <span style="color: #953800">SlowRestResource</span> <span style="color: #cf222e">extends</span> <span style="color: #953800">CompositeResource</span> <span style="color: #0550ae">{</span>
    <span style="color: #cf222e">public</span> <span style="color: #cf222e">static</span> <span style="color: #cf222e">final</span> <span style="color: #953800">String</span> <span style="color: #953800">MESSAGE</span> <span style="color: #0550ae">=</span> <span style="color: #0a3069">"It works!"</span><span style="color: #0550ae">;</span>
    <span style="color: #8250df">@GET</span>
    <span style="color: #8250df">@Produces</span><span style="color: #0550ae">(</span><span style="color: #953800">MediaType</span><span style="color: #0550ae">.</span><span style="color: #116329">TEXT_PLAIN</span><span style="color: #0550ae">)</span>
    <span style="color: #cf222e">public</span> <span style="color: #953800">String</span> <span style="color: #8250df">plain</span><span style="color: #0550ae">()</span> <span style="color: #0550ae">{</span>
        <span style="color: #cf222e">return</span> <span style="color: #953800">MESSAGE</span><span style="color: #0550ae">;</span>
    <span style="color: #0550ae">}</span>

    <span style="color: #8250df">@GET</span>
    <span style="color: #8250df">@Produces</span><span style="color: #0550ae">(</span><span style="color: #953800">SseFeature</span><span style="color: #0550ae">.</span><span style="color: #116329">SERVER_SENT_EVENTS</span><span style="color: #0550ae">)</span>
    <span style="color: #cf222e">public</span> <span style="color: #953800">EventOutput</span> <span style="color: #8250df">get</span><span style="color: #0550ae">()</span> <span style="color: #0550ae">{</span>
        <span style="color: #cf222e">return</span> <span style="color: #cf222e">this</span><span style="color: #0550ae">.</span><span style="color: #116329">executeSseCreateCommand</span><span style="color: #0550ae">(</span><span style="color: #24292f;background-color: #f6f8fa">getSubject</span><span style="color: #0550ae">(),</span> <span style="color: #0a3069">"slow-command"</span><span style="color: #0550ae">,</span>
            <span style="color: #953800">Util</span><span style="color: #0550ae">.</span><span style="color: #116329">parameterMap</span><span style="color: #0550ae">(),</span> <span style="color: #cf222e">new</span> <span style="color: #953800">ResponseBodyBuilder</span><span style="color: #0550ae">()</span> <span style="color: #0550ae">{</span>
            <span style="color: #cf222e">public</span> <span style="color: #953800">ResponseBody</span> <span style="color: #8250df">build</span><span style="color: #0550ae">(</span><span style="color: #953800">ActionReport</span> <span style="color: #24292f;background-color: #f6f8fa">report</span><span style="color: #0550ae">)</span> <span style="color: #0550ae">{</span>
                <span style="color: #cf222e">return</span> <span style="color: #953800">Util</span><span style="color: #0550ae">.</span><span style="color: #116329">responseBody</span><span style="color: #0550ae">()</span>
                <span style="color: #0550ae">.</span><span style="color: #116329">addSuccess</span><span style="color: #0550ae">(</span><span style="color: #953800">MESSAGE</span><span style="color: #0550ae">);</span>
            <span style="color: #0550ae">}</span>

        <span style="color: #0550ae">});</span>
    <span style="color: #0550ae">}</span>
<span style="color: #0550ae">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you&#8217;re familiar with JAX-RS, this should look pretty familiar, apart from the <code>RestModel</code> defined at the end. That&#8217;s part of the composite component supports extensible data model support and is (say it with me!) out of scope here. :)</p>
</div>
<div class="paragraph">
<p>This resource has a single method, <code>get()</code>, which returns an <code>EventChannel</code>. Note that <code>EventChannel</code> has been changed to <code>EventOutput</code> in more recent versions of the JAX-RS 2.0 specification (and EventChannel.SERVER_SENT_EVENTS becomes SseFeature.SERVER_SENT_EVENTS).  The real meat of the SSE handling is hidden away nicely in the executeSseCreateCommand() method.  The curious can find that in the GlassFish source repo, but it&#8217;s pretty heavily steeped in GlassFish internals. You&#8217;ve been warned. Again. :)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="the-client-side">The Client Side</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OK. So most of the server is of little interest to well over 99% of the people reading this. The interesting part is the client, and, well, it&#8217;s interesting. :)  Here is our test client:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre></td><td class="code"><pre><span style="color: #cf222e">public</span> <span style="color: #cf222e">class</span> <span style="color: #953800">SseClient</span> <span style="color: #0550ae">{</span>
    <span style="color: #cf222e">public</span> <span style="color: #cf222e">static</span> <span style="color: #cf222e">void</span> <span style="color: #8250df">main</span><span style="color: #0550ae">(</span><span style="color: #953800">String</span><span style="color: #0550ae">...</span> <span style="color: #24292f;background-color: #f6f8fa">args</span><span style="color: #0550ae">)</span> <span style="color: #cf222e">throws</span> <span style="color: #953800">IOException</span><span style="color: #0550ae">,</span> <span style="color: #953800">JSONException</span> <span style="color: #0550ae">{</span>
        <span style="color: #953800">Client</span> <span style="color: #24292f;background-color: #f6f8fa">client</span> <span style="color: #0550ae">=</span> <span style="color: #953800">JerseyClientFactory</span><span style="color: #0550ae">.</span><span style="color: #116329">newClient</span><span style="color: #0550ae">();</span>
        <span style="color: #24292f;background-color: #f6f8fa">client</span><span style="color: #0550ae">.</span><span style="color: #116329">configuration</span><span style="color: #0550ae">()</span>
                <span style="color: #0550ae">.</span><span style="color: #116329">register</span><span style="color: #0550ae">(</span><span style="color: #cf222e">new</span> <span style="color: #953800">AdminCommandStateJsonReader</span><span style="color: #0550ae">())</span>
                <span style="color: #0550ae">.</span><span style="color: #116329">register</span><span style="color: #0550ae">(</span><span style="color: #cf222e">new</span> <span style="color: #953800">ProgressStatusDTOJsonReader</span><span style="color: #0550ae">())</span>
                <span style="color: #0550ae">.</span><span style="color: #116329">register</span><span style="color: #0550ae">(</span><span style="color: #cf222e">new</span> <span style="color: #953800">ProgressStatusEventJsonReader</span><span style="color: #0550ae">())</span>
                <span style="color: #0550ae">.</span><span style="color: #116329">register</span><span style="color: #0550ae">(</span><span style="color: #953800">GfSseEventReceiverReader</span><span style="color: #0550ae">.</span><span style="color: #116329">class</span><span style="color: #0550ae">);</span>

        <span style="color: #953800">GfSseEventReceiver</span> <span style="color: #24292f;background-color: #f6f8fa">eventReceiver</span> <span style="color: #0550ae">=</span>
            <span style="color: #24292f;background-color: #f6f8fa">client</span><span style="color: #0550ae">.</span><span style="color: #116329">target</span><span style="color: #0550ae">(</span><span style="color: #0a3069">"http://localhost:4848/management/slow"</span><span style="color: #0550ae">).</span>
                <span style="color: #24292f;background-color: #f6f8fa">request</span><span style="color: #0550ae">(</span><span style="color: #953800">EventChannel</span><span style="color: #0550ae">.</span><span style="color: #116329">SERVER_SENT_EVENTS</span><span style="color: #0550ae">).</span>
                <span style="color: #24292f;background-color: #f6f8fa">get</span><span style="color: #0550ae">(</span><span style="color: #953800">GfSseEventReceiver</span><span style="color: #0550ae">.</span><span style="color: #116329">class</span><span style="color: #0550ae">);</span>
        <span style="color: #cf222e">boolean</span> <span style="color: #24292f;background-color: #f6f8fa">closeSse</span> <span style="color: #0550ae">=</span> <span style="color: #0550ae">false</span><span style="color: #0550ae">;</span>
        <span style="color: #953800">GfSseInboundEvent</span> <span style="color: #24292f;background-color: #f6f8fa">event</span><span style="color: #0550ae">;</span>
        <span style="color: #953800">ActionReport</span> <span style="color: #24292f;background-color: #f6f8fa">ar</span> <span style="color: #0550ae">=</span> <span style="color: #0550ae">null</span><span style="color: #0550ae">;</span>
        <span style="color: #953800">String</span> <span style="color: #24292f;background-color: #f6f8fa">message</span> <span style="color: #0550ae">=</span> <span style="color: #0550ae">null</span><span style="color: #0550ae">;</span>
        <span style="color: #cf222e">do</span> <span style="color: #0550ae">{</span>
            <span style="color: #24292f;background-color: #f6f8fa">event</span> <span style="color: #0550ae">=</span> <span style="color: #24292f;background-color: #f6f8fa">eventReceiver</span><span style="color: #0550ae">.</span><span style="color: #116329">readEvent</span><span style="color: #0550ae">();</span>
            <span style="color: #cf222e">if</span> <span style="color: #0550ae">(</span><span style="color: #24292f;background-color: #f6f8fa">event</span> <span style="color: #0550ae">!=</span> <span style="color: #0550ae">null</span><span style="color: #0550ae">)</span> <span style="color: #0550ae">{</span>
                <span style="color: #cf222e">final</span> <span style="color: #953800">String</span> <span style="color: #24292f;background-color: #f6f8fa">eventName</span> <span style="color: #0550ae">=</span> <span style="color: #24292f;background-color: #f6f8fa">event</span><span style="color: #0550ae">.</span><span style="color: #116329">getName</span><span style="color: #0550ae">();</span>
                <span style="color: #cf222e">if</span> <span style="color: #0550ae">(</span><span style="color: #953800">AdminCommandState</span><span style="color: #0550ae">.</span><span style="color: #116329">EVENT_STATE_CHANGED</span><span style="color: #0550ae">.</span><span style="color: #116329">equals</span><span style="color: #0550ae">(</span><span style="color: #24292f;background-color: #f6f8fa">eventName</span><span style="color: #0550ae">))</span> <span style="color: #0550ae">{</span>
                    <span style="color: #953800">AdminCommandState</span> <span style="color: #24292f;background-color: #f6f8fa">acs</span> <span style="color: #0550ae">=</span> <span style="color: #24292f;background-color: #f6f8fa">event</span><span style="color: #0550ae">.</span><span style="color: #116329">getData</span><span style="color: #0550ae">(</span><span style="color: #953800">AdminCommandState</span><span style="color: #0550ae">.</span><span style="color: #116329">class</span><span style="color: #0550ae">,</span>
                        <span style="color: #953800">MediaType</span><span style="color: #0550ae">.</span><span style="color: #116329">APPLICATION_JSON_TYPE</span><span style="color: #0550ae">);</span>
                    <span style="color: #cf222e">if</span> <span style="color: #0550ae">(</span><span style="color: #24292f;background-color: #f6f8fa">acs</span><span style="color: #0550ae">.</span><span style="color: #116329">getState</span><span style="color: #0550ae">()</span> <span style="color: #0550ae">==</span> <span style="color: #953800">AdminCommandState</span><span style="color: #0550ae">.</span><span style="color: #116329">State</span><span style="color: #0550ae">.</span><span style="color: #116329">COMPLETED</span>
                            <span style="color: #0550ae">||</span> <span style="color: #24292f;background-color: #f6f8fa">acs</span><span style="color: #0550ae">.</span><span style="color: #116329">getState</span><span style="color: #0550ae">()</span> <span style="color: #0550ae">==</span> <span style="color: #953800">AdminCommandState</span><span style="color: #0550ae">.</span><span style="color: #116329">State</span><span style="color: #0550ae">.</span><span style="color: #116329">RECORDED</span><span style="color: #0550ae">)</span> <span style="color: #0550ae">{</span>
                        <span style="color: #cf222e">if</span> <span style="color: #0550ae">(</span><span style="color: #24292f;background-color: #f6f8fa">acs</span><span style="color: #0550ae">.</span><span style="color: #116329">getActionReport</span><span style="color: #0550ae">()</span> <span style="color: #0550ae">!=</span> <span style="color: #0550ae">null</span><span style="color: #0550ae">)</span> <span style="color: #0550ae">{</span>
                            <span style="color: #24292f;background-color: #f6f8fa">ar</span> <span style="color: #0550ae">=</span> <span style="color: #24292f;background-color: #f6f8fa">acs</span><span style="color: #0550ae">.</span><span style="color: #116329">getActionReport</span><span style="color: #0550ae">();</span>
                            <span style="color: #cf222e">final</span> <span style="color: #953800">JSONObject</span> <span style="color: #24292f;background-color: #f6f8fa">responseBody</span> <span style="color: #0550ae">=</span>
                                <span style="color: #cf222e">new</span> <span style="color: #8250df">JSONObject</span><span style="color: #0550ae">((</span><span style="color: #953800">Map</span><span style="color: #0550ae">)</span><span style="color: #24292f;background-color: #f6f8fa">ar</span><span style="color: #0550ae">.</span><span style="color: #116329">getExtraProperties</span><span style="color: #0550ae">().</span><span style="color: #116329">get</span><span style="color: #0550ae">(</span><span style="color: #0a3069">"response"</span><span style="color: #0550ae">));</span>
                            <span style="color: #953800">JSONArray</span> <span style="color: #24292f;background-color: #f6f8fa">messages</span> <span style="color: #0550ae">=</span> <span style="color: #24292f;background-color: #f6f8fa">responseBody</span><span style="color: #0550ae">.</span><span style="color: #116329">getJSONArray</span><span style="color: #0550ae">(</span><span style="color: #0a3069">"messages"</span><span style="color: #0550ae">);</span>
                            <span style="color: #24292f;background-color: #f6f8fa">message</span> <span style="color: #0550ae">=</span> <span style="color: #0550ae">((</span><span style="color: #953800">JSONObject</span><span style="color: #0550ae">)</span><span style="color: #24292f;background-color: #f6f8fa">messages</span><span style="color: #0550ae">.</span><span style="color: #116329">get</span><span style="color: #0550ae">(</span><span style="color: #0550ae">0</span><span style="color: #0550ae">)).</span><span style="color: #116329">getString</span><span style="color: #0550ae">(</span><span style="color: #0a3069">"message"</span><span style="color: #0550ae">);</span>
                        <span style="color: #0550ae">}</span>
                        <span style="color: #24292f;background-color: #f6f8fa">closeSse</span> <span style="color: #0550ae">=</span> <span style="color: #0550ae">true</span><span style="color: #0550ae">;</span>
                    <span style="color: #0550ae">}</span>
                <span style="color: #0550ae">}</span>
            <span style="color: #0550ae">}</span>
        <span style="color: #0550ae">}</span> <span style="color: #cf222e">while</span> <span style="color: #0550ae">(</span><span style="color: #24292f;background-color: #f6f8fa">event</span> <span style="color: #0550ae">!=</span> <span style="color: #0550ae">null</span> <span style="color: #0550ae">&amp;&amp;</span> <span style="color: #0550ae">!</span><span style="color: #24292f;background-color: #f6f8fa">eventReceiver</span><span style="color: #0550ae">.</span><span style="color: #116329">isClosed</span><span style="color: #0550ae">()</span> <span style="color: #0550ae">&amp;&amp;</span> <span style="color: #0550ae">!</span><span style="color: #24292f;background-color: #f6f8fa">closeSse</span><span style="color: #0550ae">);</span>
        <span style="color: #cf222e">if</span> <span style="color: #0550ae">(</span><span style="color: #24292f;background-color: #f6f8fa">closeSse</span><span style="color: #0550ae">)</span> <span style="color: #0550ae">{</span>
            <span style="color: #cf222e">try</span> <span style="color: #0550ae">{</span>
                <span style="color: #24292f;background-color: #f6f8fa">eventReceiver</span><span style="color: #0550ae">.</span><span style="color: #116329">close</span><span style="color: #0550ae">();</span>
            <span style="color: #0550ae">}</span> <span style="color: #cf222e">catch</span> <span style="color: #0550ae">(</span><span style="color: #953800">Exception</span> <span style="color: #24292f;background-color: #f6f8fa">exc</span><span style="color: #0550ae">)</span> <span style="color: #0550ae">{</span>
            <span style="color: #0550ae">}</span>
        <span style="color: #0550ae">}</span>

        <span style="color: #953800">System</span><span style="color: #0550ae">.</span><span style="color: #116329">out</span><span style="color: #0550ae">.</span><span style="color: #116329">println</span><span style="color: #0550ae">(</span><span style="color: #24292f;background-color: #f6f8fa">message</span><span style="color: #0550ae">);</span>

    <span style="color: #0550ae">}</span>
<span style="color: #0550ae">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, there&#8217;s a <em>lot</em> going on here. First, we need to create and configure the client, which is the new JAX-RS <code>Client</code>. We register a few GlassFish-specific <code>MessageBodyReader</code> implementations, which are needed to deserialize the JSON responses from the server. (Note: a source comment on <code>GfSseEventReceiverReader</code> says <em>"TODO: Temporary implementation until more features in Jersey client"</em>, so this requirement may go away before GlassFish 4.0 ships). Once we have our client instance, we can make the REST request, asking Jersey to return us a <code>GfSseEventReceiver</code>. With that, we start a loop.</p>
</div>
<div class="paragraph">
<p>Inside the loop, we read an event from the receiver, and pull out its name. When calling an <code>AdminCommand</code>-backed, SSE-enabled GlassFish REST resource, you will always get at least three event types: <code>AdminCommandInstance/stateChanged</code>, <code>ProgressStatus/state</code>, and <code>ProgressStatus/change</code>. First, you will receive an <code>AdminCommandInstance/stateChanged</code> event, which will tell you (if you were to examine the JSON or the <code>AdminCommandState</code> object it becomes) that the command is "RUNNING". The next event, <code>ProgressStatus/state</code> will inform you of the initial state of the <code>ProgressStatus</code> object the server uses internal for, as you might guess, progress status. If you will look back at our <code>AdminCommand</code>, you&#8217;ll see a call to <code>progressStatus.progress()</code>. A long-running process can make these calls to denote steps in the overall process, which are then sent to the client via the <code>ProgressStatus/change</code> event.  Finally, you will receive one last <code>AdminCommandInstance/stateChanged</code> event, informing you that the command has "COMPLETED".  It might help to see the whole stream as JSON. You can request it from the server by issuing this command: <code>curl -H 'Accept: text/event-stream' <a href="http://localhost:4848/management/slow" class="bare">http://localhost:4848/management/slow</a></code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="javascript"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre></td><td class="code"><pre><span style="color: #24292f;background-color: #f6f8fa">event</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">AdminCommandInstance</span><span style="color: #0550ae">/</span><span style="color: #24292f;background-color: #f6f8fa">stateChanged</span>
<span style="color: #24292f;background-color: #f6f8fa">data</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">state</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">RUNNING</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">id</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">1</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">empty-payload</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">true</span><span style="color: #24292f;background-color: #f6f8fa">}</span>

<span style="color: #0550ae">event</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">ProgressStatus</span><span style="color: #0550ae">/</span><span style="color: #24292f;background-color: #f6f8fa">state</span>
<span style="color: #24292f;background-color: #f6f8fa">data</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">progress-status</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">name</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">slow-command</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">id</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">1</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">total-step-count</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">-</span><span style="color: #0550ae">1</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
    <span style="color: #0a3069">"</span><span style="color: #0a3069">current-step-count</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">0</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">complete</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">false</span><span style="color: #24292f;background-color: #f6f8fa">}}</span>

<span style="color: #0550ae">event</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">ProgressStatus</span><span style="color: #0550ae">/</span><span style="color: #24292f;background-color: #f6f8fa">change</span>
<span style="color: #24292f;background-color: #f6f8fa">data</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">progress-status-event</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">changed</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:[</span><span style="color: #0a3069">"</span><span style="color: #0a3069">TOTAL_STEPS</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">],</span><span style="color: #0a3069">"</span><span style="color: #0a3069">progress-status</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span>
    <span style="color: #24292f;background-color: #f6f8fa">{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">name</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">slow-command</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">id</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">1</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">total-step-count</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">5</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">current-step-count</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">0</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">complete</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">false</span><span style="color: #24292f;background-color: #f6f8fa">}}}</span>

<span style="color: #0550ae">event</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">ProgressStatus</span><span style="color: #0550ae">/</span><span style="color: #24292f;background-color: #f6f8fa">change</span>
<span style="color: #24292f;background-color: #f6f8fa">data</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">progress-status-event</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">changed</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:[</span><span style="color: #0a3069">"</span><span style="color: #0a3069">SPINNER</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">STEPS</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">],</span><span style="color: #0a3069">"</span><span style="color: #0a3069">message</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span>
    <span style="color: #0a3069">"</span><span style="color: #0a3069">Finished step #1</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">progress-status</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">name</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">slow-command</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">id</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">1</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
    <span style="color: #0a3069">"</span><span style="color: #0a3069">total-step-count</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">5</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">current-step-count</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">1</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">complete</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">false</span><span style="color: #24292f;background-color: #f6f8fa">}}}</span>

<span style="color: #0550ae">event</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">ProgressStatus</span><span style="color: #0550ae">/</span><span style="color: #24292f;background-color: #f6f8fa">change</span>
<span style="color: #24292f;background-color: #f6f8fa">data</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">progress-status-event</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">changed</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:[</span><span style="color: #0a3069">"</span><span style="color: #0a3069">SPINNER</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">STEPS</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">],</span><span style="color: #0a3069">"</span><span style="color: #0a3069">message</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span>
    <span style="color: #0a3069">"</span><span style="color: #0a3069">Finished step #2</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">progress-status</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">name</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">slow-command</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">id</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">1</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
    <span style="color: #0a3069">"</span><span style="color: #0a3069">total-step-count</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">5</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">current-step-count</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">3</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">complete</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">false</span><span style="color: #24292f;background-color: #f6f8fa">}}}</span>

<span style="color: #0550ae">event</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">ProgressStatus</span><span style="color: #0550ae">/</span><span style="color: #24292f;background-color: #f6f8fa">change</span>
<span style="color: #24292f;background-color: #f6f8fa">data</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">progress-status-event</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">changed</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:[</span><span style="color: #0a3069">"</span><span style="color: #0a3069">SPINNER</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">STEPS</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">],</span><span style="color: #0a3069">"</span><span style="color: #0a3069">message</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span>
    <span style="color: #0a3069">"</span><span style="color: #0a3069">Finished step #3</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">progress-status</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">name</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">slow-command</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">id</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">1</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
    <span style="color: #0a3069">"</span><span style="color: #0a3069">total-step-count</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">5</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">current-step-count</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">5</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">complete</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">false</span><span style="color: #24292f;background-color: #f6f8fa">}}}</span>

<span style="color: #0550ae">event</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">ProgressStatus</span><span style="color: #0550ae">/</span><span style="color: #24292f;background-color: #f6f8fa">change</span>
<span style="color: #24292f;background-color: #f6f8fa">data</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">progress-status-event</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">changed</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:[</span><span style="color: #0a3069">"</span><span style="color: #0a3069">SPINNER</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">],</span><span style="color: #0a3069">"</span><span style="color: #0a3069">message</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span>
    <span style="color: #0a3069">"</span><span style="color: #0a3069">Finished step #4</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">progress-status</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">name</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">slow-command</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">id</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">1</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
    <span style="color: #0a3069">"</span><span style="color: #0a3069">total-step-count</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">5</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">current-step-count</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">5</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">complete</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">false</span><span style="color: #24292f;background-color: #f6f8fa">}}}</span>

<span style="color: #0550ae">event</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">ProgressStatus</span><span style="color: #0550ae">/</span><span style="color: #24292f;background-color: #f6f8fa">change</span>
<span style="color: #24292f;background-color: #f6f8fa">data</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">progress-status-event</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">changed</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:[</span><span style="color: #0a3069">"</span><span style="color: #0a3069">SPINNER</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">],</span><span style="color: #0a3069">"</span><span style="color: #0a3069">message</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span>
    <span style="color: #0a3069">"</span><span style="color: #0a3069">Finished step #5</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">progress-status</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">name</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">slow-command</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">id</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">1</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
    <span style="color: #0a3069">"</span><span style="color: #0a3069">total-step-count</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">5</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">current-step-count</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">5</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">complete</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">false</span><span style="color: #24292f;background-color: #f6f8fa">}}}</span>

<span style="color: #0550ae">event</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">ProgressStatus</span><span style="color: #0550ae">/</span><span style="color: #24292f;background-color: #f6f8fa">change</span>
<span style="color: #24292f;background-color: #f6f8fa">data</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">progress-status-event</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">changed</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:[</span><span style="color: #0a3069">"</span><span style="color: #0a3069">COMPLETED</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">],</span><span style="color: #0a3069">"</span><span style="color: #0a3069">progress-status</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span>
    <span style="color: #24292f;background-color: #f6f8fa">{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">name</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">slow-command</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">id</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">1</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">total-step-count</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">5</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">current-step-count</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">5</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
    <span style="color: #0a3069">"</span><span style="color: #0a3069">complete</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">true</span><span style="color: #24292f;background-color: #f6f8fa">}}}</span>

<span style="color: #0550ae">event</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">AdminCommandInstance</span><span style="color: #0550ae">/</span><span style="color: #24292f;background-color: #f6f8fa">stateChanged</span>
<span style="color: #24292f;background-color: #f6f8fa">data</span><span style="color: #24292f;background-color: #f6f8fa">:</span> <span style="color: #24292f;background-color: #f6f8fa">{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">state</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">COMPLETED</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">id</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">1</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">empty-payload</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0550ae">true</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">action-report</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span>
    <span style="color: #24292f;background-color: #f6f8fa">{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">message</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">Slow command completed.</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">command</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">slow-command AdminCommand</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
    <span style="color: #0a3069">"</span><span style="color: #0a3069">exit_code</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">SUCCESS</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">extraProperties</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">response</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">messages</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span>
    <span style="color: #24292f;background-color: #f6f8fa">[{</span><span style="color: #0a3069">"</span><span style="color: #0a3069">message</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">It works!</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">,</span><span style="color: #0a3069">"</span><span style="color: #0a3069">severity</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">:</span><span style="color: #0a3069">"</span><span style="color: #0a3069">SUCCESS</span><span style="color: #0a3069">"</span><span style="color: #24292f;background-color: #f6f8fa">}]}}}}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Under a "normal" synchronous REST request, when the entity is created, <a href="https://wikis.oracle.com/display/GlassFish/GlassFishRestResourceGuidelines">GlassFish REST Resource Guidelines</a>, the server will return 201 (CREATED) status code, with the URI of the newly created entity in the <code>Location</code> header. Since this asynchronous, SSE-based interaction is so different, we have to return this data in a different manner.  Currently, this is done via a <code>ResponseBody</code> object (another GlassFish model) that can hold messages, as well as the item/entity.  Things in this area are likely to change as we continue to think about and stress test this functionality, so if you&#8217;re an early adopter, keep your eyes open. :)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="caveats">Caveats</h2>
<div class="sectionbody">
<div class="imageblock left">
<div class="content">
<img src="genie.jpg" alt="genie">
</div>
</div>
<div class="paragraph">
<p>If you haven&#8217;t picked up it yet, "there are a few exceptions, a few provisos, and a couple of quid pro quos."</p>
</div>
<div class="paragraph">
<p>Much of this code is brand new. There&#8217;s also quite a bit of time between now and when GlassFish 4.0 ships, so this code could change.  I&#8217;m not real comfortable with the current mechanism for returning the desired repsonse, to be honest. For example: the client code seems a bit verbose, so we might be able to provide some client-side utilities to help encapsulate that; and the JAX-RS spec continues to change as that EG refines the new revision; just to name a few.</p>
</div>
<div class="paragraph">
<p>The take away should be, then, that you can start playing with this now, with the code I&#8217;ve presented here, but you need to keep in mind that early adopters usually stub their toes a bit as products mature. :)  In one form or another, though, this support will be present when GlassFish 4.0 ships, so you can count on that, though I can&#8217;t say at this point which resources, specifically, will support SSE. Time will tell on that.</p>
</div>
<div class="paragraph">
<p>You can find the source <a href="http://blogs.steeplesoft.com/wp-content/uploads/2012/12/glassfish_rest_sse_sample.tar.gz">here</a>. If you have any questions or suggestions, see the box below. :)</p>
</div>
</div>
</div>
    </div>
    <footer>
        <div class="grid">
            <div class="col tags">
                
                <span class="title">tags: </span>
                
                <a href="/tag/glassfish/">GlassFish</a>
                <!--                <a href="https://jasondl.ee/tags/GlassFish.html">GlassFish</a>-->
                
                <a href="/tag/java-ee/">Java EE</a>
                <!--                <a href="https://jasondl.ee/tags/Java EE.html">Java EE</a>-->
                
                <a href="/tag/rest/">REST</a>
                <!--                <a href="https://jasondl.ee/tags/REST.html">REST</a>-->
                
                
            </div>
            <div class="col"><span class="share-page" style="">
  <a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://jasondl.ee/2012/using-server-sent-events-and-the-glassfish-rest-interface&title=Using Server Sent Events and the GlassFish REST Interface" rel="nofollow" target="_blank" title="Share on LinkedIn">
      <i class="fa fa-linkedin-square"></i>
  </a>
  <a class="share-twitter" href="https://twitter.com/intent/tweet?text=Using Server Sent Events and the GlassFish REST Interface&url=https://jasondl.ee/2012/using-server-sent-events-and-the-glassfish-rest-interface&via=jasondlee&related=jasondlee" rel="nofollow" target="_blank" title="Share on Twitter">
      <i class="fa fa-twitter-square"></i>
  </a>
  <a class="share-facebook" href="https://facebook.com/sharer.php?u=https://jasondl.ee/2012/using-server-sent-events-and-the-glassfish-rest-interface" rel="nofollow" target="_blank" title="Share on Facebook">
      <i class="fa fa-facebook-square"></i>
  </a>
  <a class="share-reddit" href="https://www.reddit.com/submit?url=https://jasondl.ee/2012/using-server-sent-events-and-the-glassfish-rest-interface" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Reddit" >
      <i class="fa fa-reddit-square"></i>
  </a>
  <a class="share-email" href="mailto:?subject=Using Server Sent Events and the GlassFish REST Interface&amp;body=Using Server Sent Events and the GlassFish REST Interface https://jasondl.ee/2012/using-server-sent-events-and-the-glassfish-rest-interface" title="Share via Email" >
      <i class="fa fa-envelope"></i>
  </a>
</span>
</div>
        </div>
    </footer>
</article>

        </div>
    </div>
    <div class="col-3 widget">
        <div>
            <h3>Search</h3>
            <!-- HTML elements for search -->
            <input type="text" id="search-input" placeholder="Search blog posts.." style="width: 98%"/>
            <ul id="results-container"></ul>

            <script>
                var sjs = SimpleJekyllSearch({
                    searchInput: document.getElementById('search-input'),
                    resultsContainer: document.getElementById('results-container'),
                    json: '/search.json',
                    limit: 50
                })
            </script>
        </div>
        <div>
            <h3>Quotes</h3>
            <p id="quote">Sample quote</p>
            <p id="source">Quote source</p>
        </div>
        <div>
            <h3>About</h3>
            <p><img src="/images/profile-pic.jpg" style="float:right; object-fit: scale-down; padding-bottom: 1em;"/>My name is Jason Lee. I am a software developer living in the middle of Oklahoma. I’ve been a professional developer since 1997,
using a variety of languages, including Java, Javascript, PHP, Python, Delphi, and even a bit of C#. I currently work for Red Hat
on the WildFly/EAP team, where, among other things, I maintain integrations for some MicroProfile specs, OpenTelemetry, Micrometer,
Jakarta Faces, and Bean Validation. (Full resume <a href="resume">here</a>.
LinkedIn <a href="https://www.linkedin.com/in/jasondlee">profile</a>)</p>

<p>I am the president of the Oklahoma City JUG, and an occasional speaker at the JUG and a variety of technical conferences.</p>

<p>On the personal side, I’m active in my church, and enjoy bass guitar, running, fishing, and a variety of martial arts. I’m also
married to a beautiful woman, and have two boys, who, thankfully, look like their mother.</p>

        </div>
        <div>
            <h3>My Links</h3>
            <ul>
                
                <li>
                    <a href="/presentations" title="Presentations">
                        Presentations
                    </a>
                </li>
                
                <li>
                    <a href="/assets/resume.pdf" title="Resume/CV">
                        Resume/CV
                    </a>
                </li>
                
                <li>
                    <a href="https://linkedin.com/in/jasondlee" title="LinkedIn">
                        LinkedIn
                    </a>
                </li>
                
                <li>
                    <a href="https://twitter.com/jasondlee" title="Twitter">
                        Twitter
                    </a>
                </li>
                
                <li>
                    <a href="https://mastodon.cloud/@jasondlee" title="Mastodon">
                        Mastodon
                    </a>
                </li>
                
                <li>
                    <a href="/tag" title="Tags">
                        Tags
                    </a>
                </li>
                
            </ul>

        </div>
        <div>
            <h3>Publications</h3>
            <ul>
                <li>
                    <div class="grid">
                        <div class="col-8" style="text-weight: bold; font-size: large">
                            <div>Java 9 Programming Blueprints:</div>
                            <div>
                                <a title="My Java 9 book at Amazon" href="https://amzn.to/2FD2XAo" style="padding-left: 10px">Amazon</a>
                            </div>
                            <div>
                                <a title="My Java 9 book at Packt"
                                   href="https://www.packtpub.com/application-development/java-9-programming-blueprints"
                                   style="padding-left: 10px">Packt</a>
                            </div>
                        </div>
                            <div class="col-4">
                                <a href="https://amzn.to/2FD2XAo"><img src="/images/2017/j9pb.png" width="100"/></a>
                            </div>
                    </div>
                </li>
                
                <li>
                    <a href="https://jaxenter.com/tips-for-writing-pluggable-java-ee-applications-105281.html" title="This article discusses ways to use Java EE specs to implement a simple, yet powerful plugin system with a minimum of thrid party libraries.">
                        Tips for Writing Pluggable Java EE Applications
                    </a>
                </li>
                
                <li>
                    <a href="http://www.oracle.com/technetwork/articles/javaee/jsf-templating-137822.html" title="An article Ken Paulsen and I wrote detailing easy JSF component creation">
                        JSFTemplating and Woodstock: Component Authoring Made Easy
                    </a>
                </li>
                
                <li>
                    <a href="http://jsfcentral.com/articles/lee-03-09.html" title="Jason Lee in depth: Mojarra and Scales">
                        Jason Lee in depth: Mojarra and Scales
                    </a>
                </li>
                
                <li>
                    <a href="https://web.archive.org/web/20090301060746/http://www.theserverside.com/news/thread.tss?thread_id=49343" title="My JavaOne 2008 Wrap Up">
                        Jason Lee: Postmortem for JavaOne 2008
                    </a>
                </li>
                
                <li>
                    <a href="https://web.archive.org/web/20130621192312/https://blogs.oracle.com/stories/entry/international_environmental" title="The GlassFish Adoption Story from my time at IEC">
                        International Environmental: A Cooling Company Which Prefers Hot Software
                    </a>
                </li>
                
                <li>
                    <a href="http://www.jsfcentral.com/articles/trenches_7.html" title="This details the project that spawned a couple of the Mojarra Scales components">
                        IEC donates custom JSF component to Mojarra Scales
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>
<div class="footer">
    <div>
        <p>&#169; Copyright Jason Lee, 2005-2023. All rights reserved.</p>
    </div>
</div>
<!--
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-1091049-6', 'auto');
    ga('send', 'pageview');
</script>
-->
<script src="/assets/js/quotes.js" type="text/javascript"></script>
<script src="/assets/js/local.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script>
<script type="text/javascript" src="/assets/js/copy.js"></script>
</body>
</html>
