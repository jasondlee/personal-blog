---
title: 'Announcing FacesTester'
author: 'Jason Lee'
layout: blog-post
date: 2009-3-3
tags: [ JavaServer Faces, jsf, kenai, Testing, Testing ]
---
<p>One of the issues that has always troubled me with regard to writing JSF applications (or <em>any</em> web application, really) is how hard it is to test them.  Some time ago, while discussing various Java web frameworks, I stumbled across a class called <code>WicketTester</code>, which is part of the Wicket project.  Using this class, as best as I can tell, Wicket authors can easily test their applications very quickly.  Having taken to hear the advice of Dale Hanchey, and old <a target="_blank" href="http://www.okbu.edu">college</a> professor of mine, "Never be too proud to steal a good idea," FacesTester was born.<!--more-->
</p>
<p>Unit testing a JSF application can be tricky, and there are a lot of different opinions and techniques for doing so.  Stan Silvert from JBoss, for example, just released a GA version of <a target="_blank" href="http://jboss.org/jsfunit">JSFUnit</a>, an in-container end-to-end testing framework for JSF.  Dan Allen, also of JBoss but working on the Seam project, recently discussed SeamTest in this <a target="_blank" href="http://seamframework.org/Documentation/WhatIsTheDifferenceBetweenSeamTestAndJSFUnit">wiki</a> entry.  What bothers me about both of those solutions, though, is the need for a container.  What I'd like to be able to do is write a plain, simple JUnit test to exercise my managed beans, converters, etc. without the start-up penalty of starting a container (even if it's embedded) or deploying a .war to a container.  That's where FacesTester fits in.  Though in a very early stage, FacesTester is intended to allow a JSF application developer to inspect the component tree, validate the logic and/or output of managed bean methods, etc. with a very simple and light weight API.
</p>
<p>As exciting as that may sound (I don't know about you, but in my head, it's REALLY exciting : ), don't get carried away yet.  I started this project in a very low-key fashion several weeks ago, and poked at it in my scant free time.  Last week, though, I got a call from my good friend <a target="_blank" href="http://www.rodcoffin.com/">Rod Coffin</a>, who had some unrelated JSF questions.  In the course of the conversation, testing came up, and I mentioned this pet project of mine.  Rod, a huge proponent of testing in general, immediately bit on the idea and volunteered to help.  Since that conversation, we have gotten the project to the state where we can instantiate the <code>FacesServlet</code> and request a page from our application.  We can then request a specific component and perform various tests on it.  Since we're leveraging the real, live FacesServlet, we get all the JSF goodness, including EL support, for free.  Here's an example (contrived, dumb, simple, etc) test:
</p>
<p>[source lang="xml"]
</p>
<h___form id="form">
    <h___outputLabel id="stateLabel" value="State"></h:outputText>
    <h___outputText id="elTest" value="#{4+5}"></h:outputText>
    <h___outputText id="renderedTest" rendered="false" 
<p>        value="RenderedTest">
</p>
    </h:outputText>
</h:form>[/source]
<p>Given that page definition, we can then test it like this:
</p>
<p>[source lang="java"]
</p>
<p>public class WhenNavigatingToPage {
</p>
<p>    private FacesTester tester;
</p>
<p>    @Before
</p>
<p>    public void setUp() throws Exception {
</p>
<p>        tester = new FacesTester();
</p>
<p>    }
</p>
<p>    @Test
</p>
<p>    public void shouldBeAbleToAssertValueOfComponents() throws Exception {
</p>
<p>        assertThat(tester.requestPage("/address.xhtml").getComponentWithId("form:stateLabel")
</p>
<p>            .getValueAsString(), is("State"));
</p>
<p>    }
</p>
<p>    @Test(expected = AssertionError.class)
</p>
<p>    public void shouldBeAbleToAssertValueOfNoExistentComponents() {
</p>
<p>        tester.requestPage("/address.xhtml").getComponentWithId("unknown");
</p>
<p>    }
</p>
<p>    @Test
</p>
<p>    public void shouldBeAbleToEvaluateEl() throws Exception {
</p>
<p>        assertThat(tester.requestPage("/address.xhtml"), is ("9"));
</p>
<p>    }
</p>
<p>    @Test
</p>
<p>    public void shouldBeAbleToTestRendered() throws Exception {
</p>
<p>        FacesComponent component = tester.requestPage("/address.xhtml")
</p>
<p>            .getComponentWithId("form:renderedTest");
</p>
<p>        assertThat(component.getValueAsString(),is ("RenderedTest"));
</p>
<p>        assertEquals(component.isRendered(), false);
</p>
<p>    }
</p>
<p>}[/source]
</p>
<p>As cool as that is, that's about the extent of the API at the moment, but Rod and I are very excited about what we might be able to offer with this.  The next big step for me is to get form submission working, and Rod is going to look at writing more tests and letting those drive the capabilities of FacesTester, as well writing some unit tests around bootstrapping the environment from different web.xml files.  There's a lot to be done still, so if you're interested, head over to the project <a target="_blank" href="http://kenai.com/projects/facestester">home page</a> on <a target="_blank" href="http://kenai.com">kenai.com</a> and join the fun!
</p>
<p>[tags]jsf,facestester,kenai[/tags]</p>
