<!DOCTYPE html>
<html>
<head>
    <title>Coming Up for Air : Quarkus Dev Services, jOOQ, Flyway, and Testcontainers: A Full Example</title>

    <script src="/assets/js/simple-jekyll-search.min.js" type="text/javascript"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3GQK1YDRQM"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-3GQK1YDRQM');
    </script>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="me" href="https://mastodon.cloud/@jasondlee"/>

    <link rel="alternate" type="application/rss+xml" title="jasondl.ee RSS feed" href="/feed.xml">

    <link rel="stylesheet" href="/assets/css/main.css" />

    <!-- Web Fonts -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Cherry+Cream+Soda">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Philosopher">
    <link rel="stylesheet" type="text/css" href="/assets/css/font-awesome.min.css"/>

    <link rel="stylesheet" href="https://unpkg.com/primeflex@3.1.2/primeflex.css"/>
    <link rel="stylesheet" href="https://unpkg.com/primeflex/themes/saga-blue.css"/>
    <link rel="author" href="/images/profile-pic.jpg"/>
</head>
<body>
<div class="grid">
    <div class="col blogname">
        <span>
            <a href="https://jasondl.ee">Coming Up for Air</a>
        </span>
    </div>
</div>
<div class="grid main">
    <div class="col-9">
        <div id="content">
            <article class="post">
    <h1 class="title" style="border-bottom: solid 1px #47586d; margin-bottom: 0.25rem;">
        Quarkus Dev Services, jOOQ, Flyway, and Testcontainers: A Full Example
    </h1>
    Wednesday, April 20, 2022 | <span class="share-page" style="">
  <a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://jasondl.ee/2022/quarkus-dev-services-jooq-flyway-testcontainers-full-example&title=Quarkus Dev Services, jOOQ, Flyway, and Testcontainers: A Full Example" rel="nofollow" target="_blank" title="Share on LinkedIn">
      <i class="fa fa-linkedin-square"></i>
  </a>
  <a class="share-twitter" href="https://twitter.com/intent/tweet?text=Quarkus Dev Services, jOOQ, Flyway, and Testcontainers: A Full Example&url=https://jasondl.ee/2022/quarkus-dev-services-jooq-flyway-testcontainers-full-example&via=jasondlee&related=jasondlee" rel="nofollow" target="_blank" title="Share on Twitter">
      <i class="fa fa-twitter-square"></i>
  </a>
  <a class="share-facebook" href="https://facebook.com/sharer.php?u=https://jasondl.ee/2022/quarkus-dev-services-jooq-flyway-testcontainers-full-example" rel="nofollow" target="_blank" title="Share on Facebook">
      <i class="fa fa-facebook-square"></i>
  </a>
  <a class="share-reddit" href="https://www.reddit.com/submit?url=https://jasondl.ee/2022/quarkus-dev-services-jooq-flyway-testcontainers-full-example" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Reddit" >
      <i class="fa fa-reddit-square"></i>
  </a>
  <a class="share-email" href="mailto:?subject=Quarkus Dev Services, jOOQ, Flyway, and Testcontainers: A Full Example&amp;body=Quarkus Dev Services, jOOQ, Flyway, and Testcontainers: A Full Example https://jasondl.ee/2022/quarkus-dev-services-jooq-flyway-testcontainers-full-example" title="Share via Email" >
      <i class="fa fa-envelope"></i>
  </a>
</span>

    <div>
        <div class="paragraph">
<p>I have written a few posts about using Quarkus with <a href="https://www.testcontainers.org/">Testcontainers</a>, <a href="https://flywaydb.org/">Flyway</a>, and <a href="https://www.jooq.org/">jOOQ</a>. Since posting those, I&#8217;ve learned some new tricks that have changed how I integrate the various tools. In this post, I&#8217;d like to share a complete example that shows how use Quarkus, <a href="https://quarkus.io/guides/dev-services">Quarkus Dev Services</a>, <a href="https://www.testcontainers.org/">Testcontainers</a>, and <a href="https://flywaydb.org/">Flyway</a> together for a zero (ish) local config setup.</p>
</div>
<div class="sect1">
<h2 id="introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To state things more clearly, the project developed here will have the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>No need for a locally-installed database</p>
</li>
<li>
<p>A <a href="https://flywaydb.org/">Flyway</a>-managed database schema</p>
</li>
<li>
<p>Maven-driven <a href="https://www.jooq.org/">jOOQ</a> code generation</p>
</li>
<li>
<p>A database instance using <a href="https://quarkus.io/guides/dev-services">Quarkus Dev Services</a> for use when running the Quarkus app in dev and test mode</p>
</li>
<li>
<p><a href="https://www.testcontainers.org/">Testcontainers</a>-based testing</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Buckle up. This is going to be a long one. :)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="basic-project-setup">Basic Project Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s start with the Maven setup. I won&#8217;t show the entire pom here. For that, please see the <a href="https://github.com/jasondlee/quarkus-dev-service-full-example">GitHub repo</a>.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll start by setting up <code>dependencyManagement</code> to make handling Quarkus dependencies easier:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="xml"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="code"><pre><span style="color: #116329">&lt;properties&gt;</span>
    <span style="color: #116329">&lt;version.build-helper&gt;</span>3.2.0<span style="color: #116329">&lt;/version.build-helper&gt;</span>
    <span style="color: #116329">&lt;version.compiler-plugin&gt;</span>3.8.1<span style="color: #116329">&lt;/version.compiler-plugin&gt;</span>
    <span style="color: #116329">&lt;version.flyway&gt;</span>8.4.1<span style="color: #116329">&lt;/version.flyway&gt;</span>
    <span style="color: #116329">&lt;version.jooq&gt;</span>3.16.6<span style="color: #116329">&lt;/version.jooq&gt;</span>
    <span style="color: #116329">&lt;version.junit-jupiter&gt;</span>5.8.2<span style="color: #116329">&lt;/version.junit-jupiter&gt;</span>
    <span style="color: #116329">&lt;version.pgsql-jdbc&gt;</span>42.3.3<span style="color: #116329">&lt;/version.pgsql-jdbc&gt;</span>
    <span style="color: #116329">&lt;version.quarkus&gt;</span>2.8.1.Final<span style="color: #116329">&lt;/version.quarkus&gt;</span>
    <span style="color: #116329">&lt;version.rest-assured&gt;</span>5.0.1<span style="color: #116329">&lt;/version.rest-assured&gt;</span>
    <span style="color: #116329">&lt;version.surefire&gt;</span>2.22.2<span style="color: #116329">&lt;/version.surefire&gt;</span>
    <span style="color: #116329">&lt;version.testcontainers&gt;</span>1.17.1<span style="color: #116329">&lt;/version.testcontainers&gt;</span>
<span style="color: #116329">&lt;/properties&gt;</span>

<span style="color: #116329">&lt;dependencyManagement&gt;</span>
    <span style="color: #116329">&lt;dependencies&gt;</span>
        <span style="color: #116329">&lt;dependency&gt;</span>
            <span style="color: #116329">&lt;groupId&gt;</span>io.quarkus<span style="color: #116329">&lt;/groupId&gt;</span>
            <span style="color: #116329">&lt;artifactId&gt;</span>quarkus-bom<span style="color: #116329">&lt;/artifactId&gt;</span>
            <span style="color: #116329">&lt;version&gt;</span>${version.quarkus}<span style="color: #116329">&lt;/version&gt;</span>
            <span style="color: #116329">&lt;type&gt;</span>pom<span style="color: #116329">&lt;/type&gt;</span>
            <span style="color: #116329">&lt;scope&gt;</span>import<span style="color: #116329">&lt;/scope&gt;</span>
        <span style="color: #116329">&lt;/dependency&gt;</span>
    <span style="color: #116329">&lt;/dependencies&gt;</span>
<span style="color: #116329">&lt;/dependencyManagement&gt;</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, let&#8217;s add the dependencies for the various tools we&#8217;ll be using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="xml"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre></td><td class="code"><pre><span style="color: #116329">&lt;dependencies&gt;</span>
    <span style="color: #6e7781">&lt;!-- Quarkus --&gt;</span>
    <span style="color: #116329">&lt;dependency&gt;</span>
        <span style="color: #116329">&lt;groupId&gt;</span>io.quarkus<span style="color: #116329">&lt;/groupId&gt;</span>
        <span style="color: #116329">&lt;artifactId&gt;</span>quarkus-flyway<span style="color: #116329">&lt;/artifactId&gt;</span>
    <span style="color: #116329">&lt;/dependency&gt;</span>
    <span style="color: #116329">&lt;dependency&gt;</span>
        <span style="color: #116329">&lt;groupId&gt;</span>io.quarkus<span style="color: #116329">&lt;/groupId&gt;</span>
        <span style="color: #116329">&lt;artifactId&gt;</span>quarkus-resteasy-jackson<span style="color: #116329">&lt;/artifactId&gt;</span>
    <span style="color: #116329">&lt;/dependency&gt;</span>
    <span style="color: #116329">&lt;dependency&gt;</span>
        <span style="color: #116329">&lt;groupId&gt;</span>io.quarkus<span style="color: #116329">&lt;/groupId&gt;</span>
        <span style="color: #116329">&lt;artifactId&gt;</span>quarkus-agroal<span style="color: #116329">&lt;/artifactId&gt;</span>
    <span style="color: #116329">&lt;/dependency&gt;</span>
    <span style="color: #116329">&lt;dependency&gt;</span>
        <span style="color: #116329">&lt;groupId&gt;</span>io.quarkus<span style="color: #116329">&lt;/groupId&gt;</span>
        <span style="color: #116329">&lt;artifactId&gt;</span>quarkus-jdbc-postgresql<span style="color: #116329">&lt;/artifactId&gt;</span>
    <span style="color: #116329">&lt;/dependency&gt;</span>
    <span style="color: #116329">&lt;dependency&gt;</span>
        <span style="color: #116329">&lt;groupId&gt;</span>io.quarkus<span style="color: #116329">&lt;/groupId&gt;</span>
        <span style="color: #116329">&lt;artifactId&gt;</span>quarkus-arc<span style="color: #116329">&lt;/artifactId&gt;</span>
    <span style="color: #116329">&lt;/dependency&gt;</span>
    <span style="color: #116329">&lt;dependency&gt;</span>
        <span style="color: #116329">&lt;groupId&gt;</span>io.quarkus<span style="color: #116329">&lt;/groupId&gt;</span>
        <span style="color: #116329">&lt;artifactId&gt;</span>quarkus-junit5<span style="color: #116329">&lt;/artifactId&gt;</span>
        <span style="color: #116329">&lt;scope&gt;</span>test<span style="color: #116329">&lt;/scope&gt;</span>
    <span style="color: #116329">&lt;/dependency&gt;</span>
    <span style="color: #6e7781">&lt;!-- Quarkus --&gt;</span>
    <span style="color: #6e7781">&lt;!-- jOOQ --&gt;</span>
    <span style="color: #116329">&lt;dependency&gt;</span>
        <span style="color: #116329">&lt;groupId&gt;</span>org.jooq<span style="color: #116329">&lt;/groupId&gt;</span>
        <span style="color: #116329">&lt;artifactId&gt;</span>jooq<span style="color: #116329">&lt;/artifactId&gt;</span>
        <span style="color: #116329">&lt;version&gt;</span>${version.jooq}<span style="color: #116329">&lt;/version&gt;</span>
    <span style="color: #116329">&lt;/dependency&gt;</span>
    <span style="color: #116329">&lt;dependency&gt;</span>
        <span style="color: #116329">&lt;groupId&gt;</span>org.jooq<span style="color: #116329">&lt;/groupId&gt;</span>
        <span style="color: #116329">&lt;artifactId&gt;</span>jooq-meta<span style="color: #116329">&lt;/artifactId&gt;</span>
        <span style="color: #116329">&lt;version&gt;</span>${version.jooq}<span style="color: #116329">&lt;/version&gt;</span>
    <span style="color: #116329">&lt;/dependency&gt;</span>
    <span style="color: #116329">&lt;dependency&gt;</span>
        <span style="color: #116329">&lt;groupId&gt;</span>org.jooq<span style="color: #116329">&lt;/groupId&gt;</span>
        <span style="color: #116329">&lt;artifactId&gt;</span>jooq-codegen<span style="color: #116329">&lt;/artifactId&gt;</span>
        <span style="color: #116329">&lt;version&gt;</span>${version.jooq}<span style="color: #116329">&lt;/version&gt;</span>
    <span style="color: #116329">&lt;/dependency&gt;</span>
    <span style="color: #6e7781">&lt;!-- jOOQ --&gt;</span>
    <span style="color: #6e7781">&lt;!-- JUnit --&gt;</span>
    <span style="color: #116329">&lt;dependency&gt;</span>
        <span style="color: #116329">&lt;groupId&gt;</span>org.junit.jupiter<span style="color: #116329">&lt;/groupId&gt;</span>
        <span style="color: #116329">&lt;artifactId&gt;</span>junit-jupiter<span style="color: #116329">&lt;/artifactId&gt;</span>
        <span style="color: #116329">&lt;version&gt;</span>${version.junit-jupiter}<span style="color: #116329">&lt;/version&gt;</span>
        <span style="color: #116329">&lt;scope&gt;</span>test<span style="color: #116329">&lt;/scope&gt;</span>
    <span style="color: #116329">&lt;/dependency&gt;</span>
    <span style="color: #6e7781">&lt;!-- RestAssured --&gt;</span>
    <span style="color: #116329">&lt;dependency&gt;</span>
        <span style="color: #116329">&lt;groupId&gt;</span>io.rest-assured<span style="color: #116329">&lt;/groupId&gt;</span>
        <span style="color: #116329">&lt;artifactId&gt;</span>rest-assured<span style="color: #116329">&lt;/artifactId&gt;</span>
        <span style="color: #116329">&lt;version&gt;</span>${version.rest-assured}<span style="color: #116329">&lt;/version&gt;</span>
        <span style="color: #116329">&lt;scope&gt;</span>test<span style="color: #116329">&lt;/scope&gt;</span>
    <span style="color: #116329">&lt;/dependency&gt;</span>
    <span style="color: #6e7781">&lt;!-- RestAssured --&gt;</span>
<span style="color: #116329">&lt;/dependencies&gt;</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>There will be more changes, but we&#8217;ll add those in the following sections.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="flyway-setup">Flyway Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://flywaydb.org/">Flyway</a>, as you may already know, is a tool that we can use to manage database changes more easily. What we will do then, is set up our project to use <a href="https://flywaydb.org/">Flyway</a> to manage our database for both production and test usage. We&#8217;ll start by setting up the input files. We&#8217;ll put those in <code>src/main/resources/db/migration</code> (as required by the <code>quarkus-flyway</code> extension), starting with the base schema file, <code>V0001_schema.sql</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="sql"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
</pre></td><td class="code"><pre><span style="color: #cf222e">CREATE</span> <span style="color: #cf222e">TABLE</span> <span style="color: #24292f;background-color: #f6f8fa">authors</span>
<span style="color: #24292f;background-color: #f6f8fa">(</span>
    <span style="color: #24292f;background-color: #f6f8fa">id</span>         <span style="color: #953800">INT</span> <span style="color: #cf222e">PRIMARY</span> <span style="color: #cf222e">KEY</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
    <span style="color: #24292f;background-color: #f6f8fa">last_name</span>  <span style="color: #953800">TEXT</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
    <span style="color: #24292f;background-color: #f6f8fa">first_name</span> <span style="color: #953800">TEXT</span>
<span style="color: #24292f;background-color: #f6f8fa">);</span>

<span style="color: #cf222e">CREATE</span> <span style="color: #cf222e">TABLE</span> <span style="color: #24292f;background-color: #f6f8fa">books</span>
<span style="color: #24292f;background-color: #f6f8fa">(</span>
    <span style="color: #24292f;background-color: #f6f8fa">id</span>             <span style="color: #953800">INT</span> <span style="color: #cf222e">PRIMARY</span> <span style="color: #cf222e">KEY</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
    <span style="color: #24292f;background-color: #f6f8fa">title</span>          <span style="color: #953800">TEXT</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
    <span style="color: #24292f;background-color: #f6f8fa">description</span>    <span style="color: #953800">TEXT</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
    <span style="color: #24292f;background-color: #f6f8fa">published_year</span> <span style="color: #953800">INT</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
    <span style="color: #24292f;background-color: #f6f8fa">author_id</span>      <span style="color: #953800">INT</span> <span style="color: #cf222e">NULL</span> <span style="color: #cf222e">REFERENCES</span> <span style="color: #24292f;background-color: #f6f8fa">authors</span> <span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">id</span><span style="color: #24292f;background-color: #f6f8fa">)</span>
<span style="color: #24292f;background-color: #f6f8fa">);</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>When <a href="https://flywaydb.org/">Flyway</a> runs, it will check the database to see if this file has already been processed. It does so by checking a metadata table it creates for just this purpose. If the database is persistent (as it would be in production), this file will be skipped. We&#8217;ll see, though, that our database will be ephemeral, so it will always be run. That, though, is simply a 'feature' of this demo. :)</p>
</div>
<div class="paragraph">
<p>I also like to have a file that loads dummy data so that I have something to test with, as well as to work with in dev mode while I&#8217;m working on the application (which I move/remove when getting ready for production, of course). To do that, I use a <a href="https://flywaydb.org/documentation/concepts/migrations#repeatable-migrations">repeatable migration</a>. Our example here is <code>src/main/resources/db/migration/R__dummy_data.sql</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="sql"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
</pre></td><td class="code"><pre><span style="color: #cf222e">DELETE</span> <span style="color: #cf222e">FROM</span> <span style="color: #24292f;background-color: #f6f8fa">books</span><span style="color: #24292f;background-color: #f6f8fa">;</span>
<span style="color: #cf222e">DELETE</span> <span style="color: #cf222e">FROM</span> <span style="color: #24292f;background-color: #f6f8fa">authors</span><span style="color: #24292f;background-color: #f6f8fa">;</span>
<span style="color: #cf222e">INSERT</span> <span style="color: #cf222e">INTO</span> <span style="color: #24292f;background-color: #f6f8fa">authors</span> <span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">id</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #24292f;background-color: #f6f8fa">last_name</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #24292f;background-color: #f6f8fa">first_name</span><span style="color: #24292f;background-color: #f6f8fa">)</span>
<span style="color: #cf222e">VALUES</span> <span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #0550ae">1</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #0a3069">'Tolkien'</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #0a3069">'J.R.R.'</span><span style="color: #24292f;background-color: #f6f8fa">),</span>
       <span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #0550ae">2</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #0a3069">'Lewis'</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #0a3069">'C.S'</span><span style="color: #24292f;background-color: #f6f8fa">),</span>
       <span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #0550ae">3</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #0a3069">'Sanderson'</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #0a3069">'Brandon'</span><span style="color: #24292f;background-color: #f6f8fa">),</span>
       <span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #0550ae">4</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #0a3069">'Tom'</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #0a3069">'Clancy'</span><span style="color: #24292f;background-color: #f6f8fa">);</span>

<span style="color: #cf222e">INSERT</span> <span style="color: #cf222e">INTO</span> <span style="color: #24292f;background-color: #f6f8fa">books</span> <span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">id</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #24292f;background-color: #f6f8fa">title</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #24292f;background-color: #f6f8fa">description</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #24292f;background-color: #f6f8fa">published_year</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #24292f;background-color: #f6f8fa">author_id</span><span style="color: #24292f;background-color: #f6f8fa">)</span>
<span style="color: #cf222e">VALUES</span>
       <span style="color: #6e7781">-- Source: https://www.tolkiensociety.org/actorModel/books-by-tolkien/</span>
       <span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #0550ae">1</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #0a3069">'Sir Gawain &amp; The Green Knight'</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #0a3069">'A modern translation of the Middle English romance from the stories of King Arthur.'</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #0550ae">1925</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #0550ae">1</span><span style="color: #24292f;background-color: #f6f8fa">),</span>
       <span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #0550ae">2</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #0a3069">'The Hobbit: or There and Back Again'</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #0a3069">'The bedtime story for his children famously begun on the blank page of an exam script that tells the tale of Bilbo Baggins and the dwarves in their quest to take back the Lonely Mountain from Smaug the dragon.'</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #0550ae">1937</span><span style="color: #24292f;background-color: #f6f8fa">,</span> <span style="color: #0550ae">1</span><span style="color: #24292f;background-color: #f6f8fa">),</span>
<span style="color: #6e7781">-- ...</span>
<span style="color: #24292f;background-color: #f6f8fa">;</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is our responsibility to make sure that repeatable migrations can, indeed, be repeated, so we delete everything from our two example tables. That&#8217;s overkill for our demo, but I find it a good general practice.</p>
</div>
<div class="paragraph">
<p>Now we need to wire <a href="https://flywaydb.org/">Flyway</a> into our application. Fortunately, Quarkus has built-in support for this, so we simply need to add a property to enable it. We add this in <code>src/main/resources/application.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="properties"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
</pre></td><td class="code"><pre><span style="color: #0550ae">quarkus.flyway.migrate-at-start</span><span style="color: #24292f;background-color: #f6f8fa">=</span><span style="color: #0a3069">true</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Quarkus will use the defined datasource for running <a href="https://flywaydb.org/">Flyway</a>, which we&#8217;ll configure now.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="quarkus-dev-services">Quarkus Dev Services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quoting from the <a href="https://quarkus.io/guides/dev-services">documentation</a>, "Quarkus supports the automatic provisioning of unconfigured services in development and test mode." Specifically, we&#8217;re interested in the database at this point. Quoting again from the docs, "The database Dev Services will be enabled when a reactive or JDBC datasource extension is present in the application, and the database URL has not been configured.".</p>
</div>
<div class="paragraph">
<p>So to enable <a href="https://quarkus.io/guides/dev-services">Dev Services</a>, we need to <em>not</em> configure a datasource, but we still need a datasource in production. Fortunately, Quarkus has us covered there as well. We can qualify our configuration properties for various modes. That leads us to a configuration that might look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="properties"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="code"><pre><span style="color: #0550ae">quarkus.datasource.db-kind</span><span style="color: #24292f;background-color: #f6f8fa">=</span><span style="color: #0a3069">postgresql</span>
<span style="color: #0550ae">quarkus.datasource.devservices.port</span><span style="color: #24292f;background-color: #f6f8fa">=</span><span style="color: #0a3069">54321</span>

<span style="color: #f6f8fa;background-color: #82071e">%</span><span style="color: #0550ae">prod.quarkus.datasource.jdbc.url</span><span style="color: #24292f;background-color: #f6f8fa">=</span><span style="color: #0a3069">${DATABASE_URL:jdbc:postgresql://localhost:5432/fullexample}</span>
<span style="color: #f6f8fa;background-color: #82071e">%</span><span style="color: #0550ae">prod.quarkus.datasource.username</span><span style="color: #24292f;background-color: #f6f8fa">=</span><span style="color: #0a3069">${DATABASE_USER:steeplesoft}</span>
<span style="color: #f6f8fa;background-color: #82071e">%</span><span style="color: #0550ae">prod.quarkus.datasource.password</span><span style="color: #24292f;background-color: #f6f8fa">=</span><span style="color: #0a3069">${DATABASE_PASS:steeplesoft}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>We need to tell Quarkus what kind of database we want, so we set <code>quarkus.datasource.db-kind</code>. We also don&#8217;t want to conflict with any possibly running PostgreSQL instance on a given machine, so we set the port to something less likely to conflict. It would be nice to be able to randomize this, but I&#8217;m not sure how. If you do, hit me up on <a href="https://twitter.com/jasondlee">Twitter</a>. :)</p>
</div>
<div class="paragraph">
<p>The second set of properties are prefixed with <code>%prod</code>. When running in dev or test mode, these properties will be ignored, but will be applied (minus the prefix) when the application is run in production.</p>
</div>
<div class="paragraph">
<p>The magic here is somewhat implicit. When we start the app with <code>mvn quarkus:dev</code>, since we have the <code>quarkus-agroal</code> extension included in our build, Quarkus will start up a PostgreSQL instance, as well as setting up a <code>DataSource</code>, ready for injection. Or use with <a href="https://flywaydb.org/">Flyway</a>. When we start the server in dev mode, we should see entries like the following from standard out:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
</pre></td><td class="code"><pre>[io.qua.dat.dep.dev.DevServicesDatasourceProcessor] (build-30) Dev Services for the default datasource (postgresql) started.
[org.fly.cor.int.lic.VersionPrinter] (Quarkus Main Thread) Flyway Community Edition 8.5.8 by Redgate
[org.fly.cor.int.lic.VersionPrinter] (Quarkus Main Thread) See what's new here: https://flywaydb.org/documentation/learnmore/releaseNotes#8.5.8
[org.fly.cor.int.lic.VersionPrinter] (Quarkus Main Thread)
[org.fly.cor.int.dat.bas.BaseDatabaseType] (Quarkus Main Thread) Database: jdbc:postgresql://localhost:54321/default (PostgreSQL 14.2)
[org.fly.cor.int.sch.JdbcTableSchemaHistory] (Quarkus Main Thread) Creating Schema History table "public"."flyway_schema_history" ...
[org.fly.cor.int.com.DbMigrate] (Quarkus Main Thread) Current version of schema "public": &lt;&lt; Empty Schema &gt;&gt;
[org.fly.cor.int.com.DbMigrate] (Quarkus Main Thread) Migrating schema "public" to version "0001 - schema"
[org.fly.cor.int.com.DbMigrate] (Quarkus Main Thread) Migrating schema "public" with repeatable migration "dummy data"
[org.fly.cor.int.com.DbMigrate] (Quarkus Main Thread) Successfully applied 2 migrations to schema "public", now at version v0001 (execution time 00:00.091s)
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course, the app doesn&#8217;t do anything yet, as we haven&#8217;t created any REST endpoints, but it does run, and we do have a database, which is pretty cool. Let&#8217;s take a look now at how we can integrate <a href="https://www.jooq.org/">jOOQ</a> so we can more easily access this database.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jooq-setup">jOOQ Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://www.jooq.org/">jOOQ</a>, among other things, will allow us to write type-safe queries. For certain use cases, it&#8217;s a great alternative to (or <a href="https://www.jooq.org/doc/latest/manual/getting-started/jooq-and-jpa/">supplement for!</a>) things like JPA. To get started, we need to integrate the code generation tool into our build. We&#8217;re going to do this in a way that only generates the code only if it&#8217;s missing, and we&#8217;ll add the generated output to source control to make things faster in CI and other developers machines. Let&#8217;s start with the build.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s define some properties, and the profile for the code gen:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="xml"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
</pre></td><td class="code"><pre><span style="color: #116329">&lt;properties&gt;</span>
    <span style="color: #116329">&lt;jooq.outputdir&gt;</span>src/main/jooq<span style="color: #116329">&lt;/jooq.outputdir&gt;</span>
<span style="color: #116329">&lt;/properties&gt;</span>

<span style="color: #116329">&lt;profiles&gt;</span>
    <span style="color: #116329">&lt;profile&gt;</span>
        <span style="color: #116329">&lt;id&gt;</span>codegen<span style="color: #116329">&lt;/id&gt;</span>
        <span style="color: #116329">&lt;activation&gt;</span>
            <span style="color: #116329">&lt;file&gt;</span>
                <span style="color: #116329">&lt;missing&gt;</span>${jooq.outputdir}<span style="color: #116329">&lt;/missing&gt;</span>
            <span style="color: #116329">&lt;/file&gt;</span>
        <span style="color: #116329">&lt;/activation&gt;</span>
        <span style="color: #116329">&lt;build&gt;</span>
            <span style="color: #116329">&lt;plugins&gt;</span>
                <span style="color: #116329">&lt;plugin&gt;</span>
                    <span style="color: #116329">&lt;groupId&gt;</span>org.codehaus.gmaven<span style="color: #116329">&lt;/groupId&gt;</span>
                    <span style="color: #116329">&lt;artifactId&gt;</span>groovy-maven-plugin<span style="color: #116329">&lt;/artifactId&gt;</span>
                    <span style="color: #116329">&lt;version&gt;</span>2.1.1<span style="color: #116329">&lt;/version&gt;</span>
                    <span style="color: #116329">&lt;executions&gt;</span>
                        <span style="color: #116329">&lt;execution&gt;</span>
                            <span style="color: #116329">&lt;id&gt;</span>startdb<span style="color: #116329">&lt;/id&gt;</span>
                            <span style="color: #116329">&lt;phase&gt;</span>generate-sources<span style="color: #116329">&lt;/phase&gt;</span>
                            <span style="color: #116329">&lt;goals&gt;</span>
                                <span style="color: #116329">&lt;goal&gt;</span>execute<span style="color: #116329">&lt;/goal&gt;</span>
                            <span style="color: #116329">&lt;/goals&gt;</span>
                            <span style="color: #116329">&lt;configuration&gt;</span>
                                <span style="color: #116329">&lt;source&gt;</span>
                                    db = new org.testcontainers.containers.PostgreSQLContainer("postgres:latest")
                                            .withUsername("${flyway.user}")
                                            .withDatabaseName("${flyway.user}")
                                            .withPassword("${flyway.password}")
                                    db.start()
                                    project.properties.setProperty('flyway.url', db.getJdbcUrl())
                                <span style="color: #116329">&lt;/source&gt;</span>
                            <span style="color: #116329">&lt;/configuration&gt;</span>
                        <span style="color: #116329">&lt;/execution&gt;</span>
                    <span style="color: #116329">&lt;/executions&gt;</span>
                    <span style="color: #116329">&lt;dependencies&gt;</span>
                        <span style="color: #116329">&lt;dependency&gt;</span>
                            <span style="color: #116329">&lt;groupId&gt;</span>org.testcontainers<span style="color: #116329">&lt;/groupId&gt;</span>
                            <span style="color: #116329">&lt;artifactId&gt;</span>postgresql<span style="color: #116329">&lt;/artifactId&gt;</span>
                            <span style="color: #116329">&lt;version&gt;</span>${version.testcontainers}<span style="color: #116329">&lt;/version&gt;</span>
                        <span style="color: #116329">&lt;/dependency&gt;</span>
                    <span style="color: #116329">&lt;/dependencies&gt;</span>
                <span style="color: #116329">&lt;/plugin&gt;</span>
                <span style="color: #116329">&lt;plugin&gt;</span>
                    <span style="color: #116329">&lt;groupId&gt;</span>org.flywaydb<span style="color: #116329">&lt;/groupId&gt;</span>
                    <span style="color: #116329">&lt;artifactId&gt;</span>flyway-maven-plugin<span style="color: #116329">&lt;/artifactId&gt;</span>
                    <span style="color: #116329">&lt;version&gt;</span>${version.flyway}<span style="color: #116329">&lt;/version&gt;</span>
                    <span style="color: #116329">&lt;executions&gt;</span>
                        <span style="color: #116329">&lt;execution&gt;</span>
                            <span style="color: #116329">&lt;phase&gt;</span>generate-sources<span style="color: #116329">&lt;/phase&gt;</span>
                            <span style="color: #116329">&lt;goals&gt;</span>
                                <span style="color: #116329">&lt;goal&gt;</span>migrate<span style="color: #116329">&lt;/goal&gt;</span>
                            <span style="color: #116329">&lt;/goals&gt;</span>
                        <span style="color: #116329">&lt;/execution&gt;</span>
                    <span style="color: #116329">&lt;/executions&gt;</span>
                    <span style="color: #116329">&lt;dependencies&gt;</span>
                        <span style="color: #116329">&lt;dependency&gt;</span>
                            <span style="color: #116329">&lt;groupId&gt;</span>org.postgresql<span style="color: #116329">&lt;/groupId&gt;</span>
                            <span style="color: #116329">&lt;artifactId&gt;</span>postgresql<span style="color: #116329">&lt;/artifactId&gt;</span>
                            <span style="color: #116329">&lt;version&gt;</span>${version.pgsql-jdbc}<span style="color: #116329">&lt;/version&gt;</span>
                        <span style="color: #116329">&lt;/dependency&gt;</span>
                    <span style="color: #116329">&lt;/dependencies&gt;</span>
                    <span style="color: #116329">&lt;configuration&gt;</span>
                        <span style="color: #116329">&lt;locations&gt;</span>
                            <span style="color: #116329">&lt;location&gt;</span>filesystem:src/main/resources/db/migration<span style="color: #116329">&lt;/location&gt;</span>
                        <span style="color: #116329">&lt;/locations&gt;</span>
                    <span style="color: #116329">&lt;/configuration&gt;</span>
                <span style="color: #116329">&lt;/plugin&gt;</span>
                <span style="color: #116329">&lt;plugin&gt;</span>
                    <span style="color: #116329">&lt;groupId&gt;</span>org.jooq<span style="color: #116329">&lt;/groupId&gt;</span>
                    <span style="color: #116329">&lt;artifactId&gt;</span>jooq-codegen-maven<span style="color: #116329">&lt;/artifactId&gt;</span>
                    <span style="color: #116329">&lt;version&gt;</span>${version.jooq}<span style="color: #116329">&lt;/version&gt;</span>
                    <span style="color: #116329">&lt;executions&gt;</span>
                        <span style="color: #116329">&lt;execution&gt;</span>
                            <span style="color: #116329">&lt;phase&gt;</span>generate-sources<span style="color: #116329">&lt;/phase&gt;</span>
                            <span style="color: #116329">&lt;goals&gt;</span>
                                <span style="color: #116329">&lt;goal&gt;</span>generate<span style="color: #116329">&lt;/goal&gt;</span>
                            <span style="color: #116329">&lt;/goals&gt;</span>
                        <span style="color: #116329">&lt;/execution&gt;</span>
                    <span style="color: #116329">&lt;/executions&gt;</span>
                    <span style="color: #116329">&lt;configuration&gt;</span>
                        <span style="color: #116329">&lt;jdbc&gt;</span>
                            <span style="color: #116329">&lt;url&gt;</span>${flyway.url}<span style="color: #116329">&lt;/url&gt;</span>
                            <span style="color: #116329">&lt;user&gt;</span>${flyway.user}<span style="color: #116329">&lt;/user&gt;</span>
                            <span style="color: #116329">&lt;password&gt;</span>${flyway.password}<span style="color: #116329">&lt;/password&gt;</span>
                            <span style="color: #116329">&lt;schema&gt;</span>public<span style="color: #116329">&lt;/schema&gt;</span>
                        <span style="color: #116329">&lt;/jdbc&gt;</span>
                        <span style="color: #116329">&lt;generator&gt;</span>
                            <span style="color: #116329">&lt;database&gt;</span>
                                <span style="color: #116329">&lt;name&gt;</span>org.jooq.meta.postgres.PostgresDatabase<span style="color: #116329">&lt;/name&gt;</span>
                                <span style="color: #116329">&lt;includes&gt;</span>.*<span style="color: #116329">&lt;/includes&gt;</span>
                                <span style="color: #116329">&lt;inputSchema&gt;</span>public<span style="color: #116329">&lt;/inputSchema&gt;</span>
                                <span style="color: #116329">&lt;outputSchema&gt;</span>public<span style="color: #116329">&lt;/outputSchema&gt;</span>
                            <span style="color: #116329">&lt;/database&gt;</span>
                            <span style="color: #116329">&lt;target&gt;</span>
                                <span style="color: #116329">&lt;packageName&gt;</span>com.steeplesoft.fullexample.jooq<span style="color: #116329">&lt;/packageName&gt;</span>
                                <span style="color: #116329">&lt;directory&gt;</span>${jooq.outputdir}<span style="color: #116329">&lt;/directory&gt;</span>
                            <span style="color: #116329">&lt;/target&gt;</span>
                        <span style="color: #116329">&lt;/generator&gt;</span>
                    <span style="color: #116329">&lt;/configuration&gt;</span>
                    <span style="color: #116329">&lt;dependencies&gt;</span>
                        <span style="color: #116329">&lt;dependency&gt;</span>
                            <span style="color: #116329">&lt;groupId&gt;</span>org.postgresql<span style="color: #116329">&lt;/groupId&gt;</span>
                            <span style="color: #116329">&lt;artifactId&gt;</span>postgresql<span style="color: #116329">&lt;/artifactId&gt;</span>
                            <span style="color: #116329">&lt;version&gt;</span>${version.pgsql-jdbc}<span style="color: #116329">&lt;/version&gt;</span>
                        <span style="color: #116329">&lt;/dependency&gt;</span>
                    <span style="color: #116329">&lt;/dependencies&gt;</span>
                <span style="color: #116329">&lt;/plugin&gt;</span>
            <span style="color: #116329">&lt;/plugins&gt;</span>
        <span style="color: #116329">&lt;/build&gt;</span>
    <span style="color: #116329">&lt;/profile&gt;</span>
<span style="color: #116329">&lt;/profiles&gt;</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want more details on what all&#8217;s going on here, take a moment to (re)visit my post detailing it <a href="/posts/2021/testing-with-quarkus-jooq-testcontainers-redux.ad">here</a>. In short, though:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using the <a href="https://www.testcontainers.org/">Testcontainers</a> API, we start a containerized database and grab the resulting URL</p>
</li>
<li>
<p>Using the <a href="https://flywaydb.org/">Flyway</a> Maven plugin, we run our migrations using the files defined above against this database</p>
</li>
<li>
<p>Finally, we point the <a href="https://www.jooq.org/">jOOQ</a> codegen Maven plugin at this newly populated database to generate the artifacts we&#8217;re after.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is one more step: telling Maven where to find the generated classes so we can use them. To do that, we&#8217;ll use the <code>build-helper-maven-plugin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="xml"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="code"><pre><span style="color: #116329">&lt;plugins&gt;</span>
    <span style="color: #116329">&lt;plugin&gt;</span>
        <span style="color: #116329">&lt;groupId&gt;</span>org.codehaus.mojo<span style="color: #116329">&lt;/groupId&gt;</span>
        <span style="color: #116329">&lt;artifactId&gt;</span>build-helper-maven-plugin<span style="color: #116329">&lt;/artifactId&gt;</span>
        <span style="color: #116329">&lt;version&gt;</span>${version.build-helper}<span style="color: #116329">&lt;/version&gt;</span>
        <span style="color: #116329">&lt;executions&gt;</span>
            <span style="color: #116329">&lt;execution&gt;</span>
                <span style="color: #116329">&lt;phase&gt;</span>generate-sources<span style="color: #116329">&lt;/phase&gt;</span>
                <span style="color: #116329">&lt;goals&gt;</span>
                    <span style="color: #116329">&lt;goal&gt;</span>add-source<span style="color: #116329">&lt;/goal&gt;</span>
                <span style="color: #116329">&lt;/goals&gt;</span>
                <span style="color: #116329">&lt;configuration&gt;</span>
                    <span style="color: #116329">&lt;sources&gt;</span>
                        <span style="color: #116329">&lt;source&gt;</span>${jooq.outputdir}<span style="color: #116329">&lt;/source&gt;</span>
                    <span style="color: #116329">&lt;/sources&gt;</span>
                <span style="color: #116329">&lt;/configuration&gt;</span>
            <span style="color: #116329">&lt;/execution&gt;</span>
        <span style="color: #116329">&lt;/executions&gt;</span>
    <span style="color: #116329">&lt;/plugin&gt;</span>
<span style="color: #116329">&lt;/plugins&gt;</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now Maven, as well as any IDE that bases its project information on the Maven POM, will be able to see these classes. We can <code>git add src/main/jooq</code> to add these to git, and, when there are changes to the schema, we simply execute something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="bash"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
3
</pre></td><td class="code"><pre><span style="color: #0550ae">$ </span><span style="color: #953800">rm</span> <span style="color: #116329">-rf</span> src/main/jooq
<span style="color: #0550ae">$ </span>mvn generate-sources
<span style="color: #0550ae">$ </span>git add src/main/jooq
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s probably a bit heavy-handed, but it should work. :) If you have a more elegant solution, again, find me on <a href="https://twitter.com/jasondlee">Twitter</a>. :)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="writing-the-first-endpoint">Writing the first endpoint</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We now have a database instance started for us, we have the schema being created and dummy data add automatically, and we have the <a href="https://www.jooq.org/">jOOQ</a> classes we need to more safely access the data, so let&#8217;s write a very simple endpoint to show off our hard work.</p>
</div>
<div class="paragraph">
<p>First, we need the <code>DSLContext</code>, so let&#8217;s create a CDI Producer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="code"><pre><span style="color: #cf222e">public</span> <span style="color: #cf222e">final</span> <span style="color: #cf222e">class</span> <span style="color: #953800">DslContextProducer</span> <span style="color: #0550ae">{</span>
    <span style="color: #8250df">@Inject</span>
    <span style="color: #cf222e">protected</span> <span style="color: #953800">DataSource</span> <span style="color: #24292f;background-color: #f6f8fa">dataSource</span><span style="color: #0550ae">;</span>

    <span style="color: #8250df">@Produces</span>
    <span style="color: #8250df">@RequestScoped</span>
    <span style="color: #cf222e">public</span> <span style="color: #953800">DSLContext</span> <span style="color: #8250df">getDslContext</span><span style="color: #0550ae">()</span> <span style="color: #0550ae">{</span>
        <span style="color: #cf222e">try</span> <span style="color: #0550ae">{</span>
            <span style="color: #cf222e">return</span> <span style="color: #953800">DSL</span><span style="color: #0550ae">.</span><span style="color: #116329">using</span><span style="color: #0550ae">(</span><span style="color: #24292f;background-color: #f6f8fa">getConfiguration</span><span style="color: #0550ae">());</span>
        <span style="color: #0550ae">}</span> <span style="color: #cf222e">catch</span> <span style="color: #0550ae">(</span><span style="color: #953800">Exception</span> <span style="color: #24292f;background-color: #f6f8fa">e</span><span style="color: #0550ae">)</span> <span style="color: #0550ae">{</span>
            <span style="color: #cf222e">throw</span> <span style="color: #cf222e">new</span> <span style="color: #8250df">RuntimeException</span><span style="color: #0550ae">(</span><span style="color: #24292f;background-color: #f6f8fa">e</span><span style="color: #0550ae">);</span>
        <span style="color: #0550ae">}</span>
    <span style="color: #0550ae">}</span>

    <span style="color: #cf222e">private</span> <span style="color: #953800">Configuration</span> <span style="color: #8250df">getConfiguration</span><span style="color: #0550ae">()</span> <span style="color: #0550ae">{</span>
        <span style="color: #cf222e">return</span> <span style="color: #cf222e">new</span> <span style="color: #8250df">DefaultConfiguration</span><span style="color: #0550ae">()</span>
                <span style="color: #0550ae">.</span><span style="color: #116329">set</span><span style="color: #0550ae">(</span><span style="color: #24292f;background-color: #f6f8fa">dataSource</span><span style="color: #0550ae">)</span>
                <span style="color: #0550ae">.</span><span style="color: #116329">set</span><span style="color: #0550ae">(</span><span style="color: #cf222e">new</span> <span style="color: #953800">Settings</span><span style="color: #0550ae">()</span>
                        <span style="color: #0550ae">.</span><span style="color: #116329">withExecuteLogging</span><span style="color: #0550ae">(</span><span style="color: #0550ae">true</span><span style="color: #0550ae">)</span>
                        <span style="color: #0550ae">.</span><span style="color: #116329">withRenderFormatted</span><span style="color: #0550ae">(</span><span style="color: #0550ae">true</span><span style="color: #0550ae">)</span>
                        <span style="color: #0550ae">.</span><span style="color: #116329">withRenderCatalog</span><span style="color: #0550ae">(</span><span style="color: #0550ae">false</span><span style="color: #0550ae">)</span>
                        <span style="color: #0550ae">.</span><span style="color: #116329">withRenderSchema</span><span style="color: #0550ae">(</span><span style="color: #0550ae">false</span><span style="color: #0550ae">)</span>
                        <span style="color: #0550ae">.</span><span style="color: #116329">withMaxRows</span><span style="color: #0550ae">(</span><span style="color: #953800">Integer</span><span style="color: #0550ae">.</span><span style="color: #116329">MAX_VALUE</span><span style="color: #0550ae">)</span>
                        <span style="color: #0550ae">.</span><span style="color: #116329">withRenderQuotedNames</span><span style="color: #0550ae">(</span><span style="color: #953800">RenderQuotedNames</span><span style="color: #0550ae">.</span><span style="color: #116329">EXPLICIT_DEFAULT_UNQUOTED</span><span style="color: #0550ae">)</span>
                        <span style="color: #0550ae">.</span><span style="color: #116329">withRenderNameCase</span><span style="color: #0550ae">(</span><span style="color: #953800">RenderNameCase</span><span style="color: #0550ae">.</span><span style="color: #116329">LOWER_IF_UNQUOTED</span><span style="color: #0550ae">)</span>
                <span style="color: #0550ae">);</span>
    <span style="color: #0550ae">}}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a pretty simple CDI producer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We&#8217;re injecting the <code>DataSource</code> that Quarkus provides us. It will either be one for the <a href="https://quarkus.io/guides/dev-services">Dev Services</a> database in dev or test mode, or the "real" one in production mode.</p>
</li>
<li>
<p>We pass that <code>DataSource</code> to <a href="https://www.jooq.org/">jOOQ</a> via the <code>Configuration</code> object.</p>
</li>
<li>
<p>Bob&#8217;s your uncle.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The REST endpoint could look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="code"><pre><span style="color: #cf222e">import</span> <span style="color: #953800">static</span> <span style="color: #24292f;background-color: #f6f8fa">com</span><span style="color: #0550ae">.</span><span style="color: #116329">steeplesoft</span><span style="color: #0550ae">.</span><span style="color: #116329">fullexample</span><span style="color: #0550ae">.</span><span style="color: #116329">jooq</span><span style="color: #0550ae">.</span><span style="color: #116329">tables</span><span style="color: #0550ae">.</span><span style="color: #116329">Authors</span><span style="color: #0550ae">.</span><span style="color: #116329">AUTHORS</span><span style="color: #0550ae">;</span>

<span style="color: #cf222e">import</span> <span style="color: #953800">java.util.List</span><span style="color: #0550ae">;</span>
<span style="color: #cf222e">import</span> <span style="color: #953800">javax.inject.Inject</span><span style="color: #0550ae">;</span>
<span style="color: #cf222e">import</span> <span style="color: #953800">javax.ws.rs.GET</span><span style="color: #0550ae">;</span>
<span style="color: #cf222e">import</span> <span style="color: #953800">javax.ws.rs.Path</span><span style="color: #0550ae">;</span>

<span style="color: #cf222e">import</span> <span style="color: #953800">org.jooq.DSLContext</span><span style="color: #0550ae">;</span>

<span style="color: #8250df">@Path</span><span style="color: #0550ae">(</span><span style="color: #0a3069">"/authors"</span><span style="color: #0550ae">)</span>
<span style="color: #cf222e">public</span> <span style="color: #cf222e">class</span> <span style="color: #953800">AuthorsResource</span> <span style="color: #0550ae">{</span>
    <span style="color: #8250df">@Inject</span>
    <span style="color: #953800">DSLContext</span> <span style="color: #24292f;background-color: #f6f8fa">context</span><span style="color: #0550ae">;</span>

    <span style="color: #8250df">@GET</span>
    <span style="color: #cf222e">public</span> <span style="color: #953800">List</span><span style="color: #0550ae">&lt;</span><span style="color: #953800">AuthorDTO</span><span style="color: #0550ae">&gt;</span> <span style="color: #8250df">getAuthors</span><span style="color: #0550ae">()</span> <span style="color: #0550ae">{</span>
        <span style="color: #cf222e">return</span> <span style="color: #24292f;background-color: #f6f8fa">context</span><span style="color: #0550ae">.</span><span style="color: #116329">select</span><span style="color: #0550ae">()</span>
                <span style="color: #0550ae">.</span><span style="color: #116329">from</span><span style="color: #0550ae">(</span><span style="color: #953800">AUTHORS</span><span style="color: #0550ae">)</span>
                <span style="color: #0550ae">.</span><span style="color: #116329">fetchInto</span><span style="color: #0550ae">(</span><span style="color: #953800">AuthorDTO</span><span style="color: #0550ae">.</span><span style="color: #116329">class</span><span style="color: #0550ae">);</span>
    <span style="color: #0550ae">}</span>
<span style="color: #0550ae">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that it&#8217;s generally not a good idea to access the database in the REST layer, but I&#8217;ve done so here to keep things simple, and the usage of <a href="https://www.jooq.org/">jOOQ</a> here is very simple as well, so I won&#8217;t spend too much time on it.</p>
</div>
<div class="paragraph">
<p>With this overly simple REST endpoint in place, we&#8217;ve demonstrated <a href="https://quarkus.io/guides/dev-services">Quarkus Dev Services</a>, <a href="https://flywaydb.org/">Flyway</a>, and <a href="https://www.jooq.org/">jOOQ</a>. Let&#8217;s finish with testing this with <a href="https://www.testcontainers.org/">Testcontainers</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing-with-testcontainers">Testing with Testcontainers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In a <a href="/posts/2021/testing-with-quarkus-jooq-testcontainers.ad">previous post</a>, I discussed setting up a test using Testcontainers, but I did so using Kotlin. In another <a href="/posts/2022/testing-with-quarkus-jooq-testcontainers-redux.ad">post</a>, I did the same thing, but I booted the database from Maven using the <code>groovy-maven-plugin</code>. While those work, there&#8217;s an even better way: let Quarkus do it for us.</p>
</div>
<div class="paragraph">
<p>Way back up the page a bit, we saw how the <code>quarkus-agroal</code> extension will create a containerized database instance for when run in dev and <em>test</em> mode. As it turns out, we&#8217;re running in test mode here, so Quarkus will create and start the database for us and create the <code>DataSource</code> for us. This is injected normally as it was above, with no changes to the classes under test. All we have to do, then, is write the test.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
</pre></td><td class="code"><pre><span style="color: #cf222e">import</span> <span style="color: #953800">static</span> <span style="color: #24292f;background-color: #f6f8fa">io</span><span style="color: #0550ae">.</span><span style="color: #116329">restassured</span><span style="color: #0550ae">.</span><span style="color: #116329">RestAssured</span><span style="color: #0550ae">.</span><span style="color: #116329">when</span><span style="color: #0550ae">;</span>

<span style="color: #cf222e">import</span> <span style="color: #953800">io.quarkus.test.common.http.TestHTTPEndpoint</span><span style="color: #0550ae">;</span>
<span style="color: #cf222e">import</span> <span style="color: #953800">io.quarkus.test.junit.QuarkusTest</span><span style="color: #0550ae">;</span>
<span style="color: #cf222e">import</span> <span style="color: #953800">org.junit.jupiter.api.Test</span><span style="color: #0550ae">;</span>

<span style="color: #8250df">@QuarkusTest</span>
<span style="color: #8250df">@TestHTTPEndpoint</span><span style="color: #0550ae">(</span><span style="color: #953800">AuthorsResource</span><span style="color: #0550ae">.</span><span style="color: #116329">class</span><span style="color: #0550ae">)</span>
<span style="color: #cf222e">public</span> <span style="color: #cf222e">class</span> <span style="color: #953800">AuthorsResourceTest</span> <span style="color: #0550ae">{</span>
    <span style="color: #8250df">@Test</span>
    <span style="color: #cf222e">public</span> <span style="color: #cf222e">void</span> <span style="color: #8250df">testEndpoint</span><span style="color: #0550ae">()</span> <span style="color: #0550ae">{</span>
        <span style="color: #24292f;background-color: #f6f8fa">when</span><span style="color: #0550ae">().</span><span style="color: #116329">get</span><span style="color: #0550ae">(</span><span style="color: #0a3069">"/"</span><span style="color: #0550ae">)</span>
                <span style="color: #0550ae">.</span><span style="color: #116329">then</span><span style="color: #0550ae">()</span>
                <span style="color: #0550ae">.</span><span style="color: #116329">log</span><span style="color: #0550ae">()</span>
                <span style="color: #0550ae">.</span><span style="color: #116329">body</span><span style="color: #0550ae">()</span>
                <span style="color: #0550ae">.</span><span style="color: #116329">statusCode</span><span style="color: #0550ae">(</span><span style="color: #0550ae">200</span><span style="color: #0550ae">);</span>
    <span style="color: #0550ae">}</span>
<span style="color: #0550ae">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is, admittedly, kind of a dumb test, but it does demonstrate the use the Quarkus test framework, which handles starting and stopping the server for us, allowing us to easily write unit tests against it. The test is full <code>@Inject</code>-able as well. If we wanted to inject the <code>DataSource</code> or the <code>DSLContext</code>, we would simply add the injection point like we would in production code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span style="color: #8250df">@Inject</span>
<span style="color: #953800">DSLContext</span> <span style="color: #24292f;background-color: #f6f8fa">context</span><span style="color: #0550ae">;</span>

<span style="color: #8250df">@Test</span>
<span style="color: #cf222e">public</span> <span style="color: #cf222e">void</span> <span style="color: #8250df">testContextInjection</span><span style="color: #0550ae">()</span> <span style="color: #0550ae">{</span>
    <span style="color: #953800">Assertions</span><span style="color: #0550ae">.</span><span style="color: #116329">assertNotNull</span><span style="color: #0550ae">(</span><span style="color: #24292f;background-color: #f6f8fa">context</span><span style="color: #0550ae">);</span>
<span style="color: #0550ae">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that it does take a while for the tests to start running. That&#8217;s because <a href="https://quarkus.io/guides/dev-services">Dev Services</a> is spinning up the database instance, which is not a cheap operation. The start of our application is quite quick, however, once the DB is ready.</p>
</div>
<div class="paragraph">
<p>It&#8217;s also worth noting that, in our tests, we&#8217;re not actually interacting with <a href="https://www.testcontainers.org/">Testcontainers</a> directly. Quarkus is doing that on our behalf. If you edit the logging configuration to allow it, you&#8217;ll see output like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="color: #24292f;background-color: #f6f8fa"><code><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="code"><pre>[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running com.steeplesoft.fullexample.AuthorsResourceTest
[org.jbo.threads] (main) JBoss Threads version 3.4.2.Final
[org.tes.doc.DockerClientProviderStrategy] (build-30) Loaded org.testcontainers.dockerclient.UnixSocketClientProviderStrategy from ~/.testcontainers.properties, will try it first
[com.git.doc.zer.sha.org.apa.hc.cli.htt.imp.cla.HttpRequestRetryExec] (ducttape-0) Recoverable I/O exception (java.io.IOException) caught when processing request to {}-&gt;unix://localhost:2375
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The only place we use <a href="https://www.testcontainers.org/">Testcontainers</a> directly is in our <a href="https://flywaydb.org/">Flyway</a>/codegen configuration above, but it&#8217;s still there, and it&#8217;s still awesome. :)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this project, we show a complete&#8201;&#8212;&#8201;if simple&#8201;&#8212;&#8201;integration of several important technologies which will allow use to write REST endpoints quickly and easily, and we need to worry (too much) about the local environment, whether it&#8217;s our machine, a coworkers, or even, say, a Github Action. If the machine has Java and Maven installed (and git and docker, of course), it&#8217;s simply a matter of cloning the project and issuing <code>mvn clean install</code> to build, test, and package the application.</p>
</div>
<div class="paragraph">
<p>In case you missed the link above, you can find this complete example <a href="https://github.com/jasondlee/quarkus-dev-service-full-example">here</a>.</p>
</div>
<div class="paragraph">
<p>Hopefully, you&#8217;ll find this helpful. If you have problems, or suggestions on how to prove it, find me on <a href="https://twitter.com/jasondlee">Twitter</a> and let&#8217;s talk.</p>
</div>
</div>
</div>
    </div>
    <footer>
        <div class="grid">
            <div class="col tags">
                
                <span class="title">tags: </span>
                
                <a href="/tag/java/">Java</a>
                <!--                <a href="https://jasondl.ee/tags/Java.html">Java</a>-->
                
                <a href="/tag/quarkus/">Quarkus</a>
                <!--                <a href="https://jasondl.ee/tags/Quarkus.html">Quarkus</a>-->
                
                <a href="/tag/flyway/">Flyway</a>
                <!--                <a href="https://jasondl.ee/tags/Flyway.html">Flyway</a>-->
                
                <a href="/tag/testcontainers/">Testcontainers</a>
                <!--                <a href="https://jasondl.ee/tags/Testcontainers.html">Testcontainers</a>-->
                
                
            </div>
            <div class="col"><span class="share-page" style="">
  <a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://jasondl.ee/2022/quarkus-dev-services-jooq-flyway-testcontainers-full-example&title=Quarkus Dev Services, jOOQ, Flyway, and Testcontainers: A Full Example" rel="nofollow" target="_blank" title="Share on LinkedIn">
      <i class="fa fa-linkedin-square"></i>
  </a>
  <a class="share-twitter" href="https://twitter.com/intent/tweet?text=Quarkus Dev Services, jOOQ, Flyway, and Testcontainers: A Full Example&url=https://jasondl.ee/2022/quarkus-dev-services-jooq-flyway-testcontainers-full-example&via=jasondlee&related=jasondlee" rel="nofollow" target="_blank" title="Share on Twitter">
      <i class="fa fa-twitter-square"></i>
  </a>
  <a class="share-facebook" href="https://facebook.com/sharer.php?u=https://jasondl.ee/2022/quarkus-dev-services-jooq-flyway-testcontainers-full-example" rel="nofollow" target="_blank" title="Share on Facebook">
      <i class="fa fa-facebook-square"></i>
  </a>
  <a class="share-reddit" href="https://www.reddit.com/submit?url=https://jasondl.ee/2022/quarkus-dev-services-jooq-flyway-testcontainers-full-example" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Reddit" >
      <i class="fa fa-reddit-square"></i>
  </a>
  <a class="share-email" href="mailto:?subject=Quarkus Dev Services, jOOQ, Flyway, and Testcontainers: A Full Example&amp;body=Quarkus Dev Services, jOOQ, Flyway, and Testcontainers: A Full Example https://jasondl.ee/2022/quarkus-dev-services-jooq-flyway-testcontainers-full-example" title="Share via Email" >
      <i class="fa fa-envelope"></i>
  </a>
</span>
</div>
        </div>
    </footer>
</article>

        </div>
    </div>
    <div class="col-3 widget">
        <div>
            <h3>Search</h3>
            <!-- HTML elements for search -->
            <input type="text" id="search-input" placeholder="Search blog posts.." style="width: 98%"/>
            <ul id="results-container"></ul>

            <script>
                var sjs = SimpleJekyllSearch({
                    searchInput: document.getElementById('search-input'),
                    resultsContainer: document.getElementById('results-container'),
                    json: '/search.json',
                    limit: 50
                })
            </script>
        </div>
        <div>
            <h3>Quotes</h3>
            <p id="quote">Sample quote</p>
            <p id="source">Quote source</p>
        </div>
        <div>
            <h3>About</h3>
            <p><img src="/images/profile-pic.jpg" style="float:right; object-fit: scale-down; padding-bottom: 1em;"/>My name is Jason Lee. I am a software developer living in the middle of Oklahoma. I’ve been a professional developer since 1997,
using a variety of languages, including Java, Javascript, PHP, Python, Delphi, and even a bit of C#. I currently work for Red Hat
on the WildFly/EAP team, where, among other things, I maintain integrations for some MicroProfile specs, OpenTelemetry, Micrometer,
Jakarta Faces, and Bean Validation. (Full resume <a href="resume">here</a>.
LinkedIn <a href="https://www.linkedin.com/in/jasondlee">profile</a>)</p>

<p>I am the president of the Oklahoma City JUG, and an occasional speaker at the JUG and a variety of technical conferences.</p>

<p>On the personal side, I’m active in my church, and enjoy bass guitar, running, fishing, and a variety of martial arts. I’m also
married to a beautiful woman, and have two boys, who, thankfully, look like their mother.</p>

        </div>
        <div>
            <h3>My Links</h3>
            <ul>
                
                <li>
                    <a href="/presentations" title="Presentations">
                        Presentations
                    </a>
                </li>
                
                <li>
                    <a href="/assets/resume.pdf" title="Resume/CV">
                        Resume/CV
                    </a>
                </li>
                
                <li>
                    <a href="https://linkedin.com/in/jasondlee" title="LinkedIn">
                        LinkedIn
                    </a>
                </li>
                
                <li>
                    <a href="https://twitter.com/jasondlee" title="Twitter">
                        Twitter
                    </a>
                </li>
                
                <li>
                    <a href="https://mastodon.cloud/@jasondlee" title="Mastodon">
                        Mastodon
                    </a>
                </li>
                
                <li>
                    <a href="/tag" title="Tags">
                        Tags
                    </a>
                </li>
                
            </ul>

        </div>
        <div>
            <h3>Publications</h3>
            <ul>
                <li>
                    <div class="grid">
                        <div class="col-8" style="text-weight: bold; font-size: large">
                            <div>Java 9 Programming Blueprints:</div>
                            <div>
                                <a title="My Java 9 book at Amazon" href="https://amzn.to/2FD2XAo" style="padding-left: 10px">Amazon</a>
                            </div>
                            <div>
                                <a title="My Java 9 book at Packt"
                                   href="https://www.packtpub.com/application-development/java-9-programming-blueprints"
                                   style="padding-left: 10px">Packt</a>
                            </div>
                        </div>
                            <div class="col-4">
                                <a href="https://amzn.to/2FD2XAo"><img src="/images/2017/j9pb.png" width="100"/></a>
                            </div>
                    </div>
                </li>
                
                <li>
                    <a href="https://jaxenter.com/tips-for-writing-pluggable-java-ee-applications-105281.html" title="This article discusses ways to use Java EE specs to implement a simple, yet powerful plugin system with a minimum of thrid party libraries.">
                        Tips for Writing Pluggable Java EE Applications
                    </a>
                </li>
                
                <li>
                    <a href="http://www.oracle.com/technetwork/articles/javaee/jsf-templating-137822.html" title="An article Ken Paulsen and I wrote detailing easy JSF component creation">
                        JSFTemplating and Woodstock: Component Authoring Made Easy
                    </a>
                </li>
                
                <li>
                    <a href="http://jsfcentral.com/articles/lee-03-09.html" title="Jason Lee in depth: Mojarra and Scales">
                        Jason Lee in depth: Mojarra and Scales
                    </a>
                </li>
                
                <li>
                    <a href="https://web.archive.org/web/20090301060746/http://www.theserverside.com/news/thread.tss?thread_id=49343" title="My JavaOne 2008 Wrap Up">
                        Jason Lee: Postmortem for JavaOne 2008
                    </a>
                </li>
                
                <li>
                    <a href="https://web.archive.org/web/20130621192312/https://blogs.oracle.com/stories/entry/international_environmental" title="The GlassFish Adoption Story from my time at IEC">
                        International Environmental: A Cooling Company Which Prefers Hot Software
                    </a>
                </li>
                
                <li>
                    <a href="http://www.jsfcentral.com/articles/trenches_7.html" title="This details the project that spawned a couple of the Mojarra Scales components">
                        IEC donates custom JSF component to Mojarra Scales
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>
<div class="footer">
    <div>
        <p>&#169; Copyright Jason Lee, 2005-2023. All rights reserved.</p>
    </div>
</div>
<!--
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-1091049-6', 'auto');
    ga('send', 'pageview');
</script>
-->
<script src="/assets/js/quotes.js" type="text/javascript"></script>
<script src="/assets/js/local.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script>
<script type="text/javascript" src="/assets/js/copy.js"></script>
</body>
</html>
